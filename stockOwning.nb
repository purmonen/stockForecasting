(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     74365,       1563]
NotebookOptionsPosition[     73138,       1520]
NotebookOutlinePosition[     73498,       1536]
CellTagsIndexPosition[     73455,       1533]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  StyleBox[
   RowBox[{"Stock", " ", "Data"}], "Title"], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"stockData", " ", "=", "  ", 
   RowBox[{"FinancialData", "[", 
    RowBox[{"\"\<^FTSE\>\"", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"DateObject", "[", 
        RowBox[{"{", 
         RowBox[{"2005", ",", "1", ",", "1"}], "}"}], "]"}], ",", 
       RowBox[{"DateObject", "[", 
        RowBox[{"{", 
         RowBox[{"2005", ",", "6", ",", "1"}], "}"}], "]"}]}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"stockPrices", " ", "=", 
   RowBox[{"stockData", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", " ", "2"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"allRealPrices", " ", "=", " ", 
   RowBox[{"stockPrices", "[", 
    RowBox[{"[", 
     RowBox[{"2", ";;", 
      RowBox[{"-", "1"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"allBeforeRealPrices", " ", "=", " ", 
   RowBox[{"stockPrices", "[", 
    RowBox[{"[", 
     RowBox[{"1", ";;", 
      RowBox[{"-", "2"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"priceChanges", " ", "=", " ", 
   RowBox[{"allRealPrices", " ", "/", " ", "allBeforeRealPrices"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Length", "[", "stockPrices", "]"}], "\[IndentingNewLine]", 
 RowBox[{"plot", " ", "=", " ", 
  RowBox[{"ListLinePlot", "[", 
   RowBox[{
    RowBox[{"{", "stockPrices", "}"}], ",", 
    RowBox[{"PlotLegends", "\[Rule]", 
     RowBox[{"{", "\"\<HSI\>\"", "}"}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.6327429749183187`*^9, 3.632743020241493*^9}, {
   3.6327430626191893`*^9, 3.632743090887294*^9}, {3.6327431696368628`*^9, 
   3.632743265307125*^9}, {3.632818908440407*^9, 3.632818918693774*^9}, {
   3.632819209839077*^9, 3.632819277820066*^9}, {3.632824267972762*^9, 
   3.632824342950367*^9}, 3.6328244537699013`*^9, {3.632824489662837*^9, 
   3.632824492534006*^9}, {3.632826927606759*^9, 3.632827019607327*^9}, {
   3.632827051698964*^9, 3.632827075833501*^9}, {3.6328283338475122`*^9, 
   3.6328283756134577`*^9}, {3.632828490184004*^9, 3.6328286814064407`*^9}, {
   3.632828713009672*^9, 3.6328289183841753`*^9}, 3.6328289841993227`*^9, 
   3.632829784376502*^9, {3.632829846230926*^9, 3.6328299638828087`*^9}, 
   3.632830301095127*^9, {3.632830702617859*^9, 3.63283070324082*^9}, {
   3.632830800887021*^9, 3.632830803951688*^9}, {3.632830837346504*^9, 
   3.6328308456632967`*^9}, {3.632832892496992*^9, 3.632832901906269*^9}, {
   3.632833024787912*^9, 3.632833026149979*^9}, {3.632891562899342*^9, 
   3.6328915983158092`*^9}, {3.6328916456009893`*^9, 3.632891648448402*^9}, {
   3.6328933614187*^9, 3.632893365882728*^9}, {3.632893431404941*^9, 
   3.63289344618089*^9}, {3.6328940573041353`*^9, 3.6328940790629587`*^9}, {
   3.632894741618835*^9, 3.6328947444438467`*^9}, {3.632896710633057*^9, 
   3.632896710820706*^9}, {3.632896742567802*^9, 3.63289674313235*^9}, {
   3.6328973402368803`*^9, 3.632897348356823*^9}, {3.632899649473171*^9, 
   3.632899649557293*^9}, {3.632900485425768*^9, 3.6329004950102177`*^9}, {
   3.632901775916894*^9, 3.632901776181129*^9}, {3.632903877523225*^9, 
   3.632903959212545*^9}, {3.632903990981168*^9, 3.632904025699132*^9}, {
   3.632906452461577*^9, 3.632906470227483*^9}, {3.632906520119938*^9, 
   3.632906521045575*^9}, {3.632907193195321*^9, 3.6329072136441317`*^9}, {
   3.6329905250634127`*^9, 3.632990591188364*^9}, {3.632991561295353*^9, 
   3.632991570103318*^9}, {3.632991636057946*^9, 3.632991659106139*^9}, {
   3.6329920227291727`*^9, 3.63299203946486*^9}, {3.6329921663668833`*^9, 
   3.632992166575158*^9}, {3.632992524673924*^9, 3.632992525744252*^9}, {
   3.6329925601540537`*^9, 3.632992560272737*^9}, {3.63299272898595*^9, 
   3.632992729041778*^9}, {3.6329957872645693`*^9, 3.632995787818033*^9}, {
   3.632996556565926*^9, 3.632996594273795*^9}, {3.6393017045235023`*^9, 
   3.639301704761613*^9}, {3.639301738948237*^9, 3.639301742862405*^9}, {
   3.6393017848600063`*^9, 3.639301803864708*^9}, {3.6393018471736603`*^9, 
   3.6393019869752283`*^9}, {3.639302373634831*^9, 3.63930241856748*^9}, {
   3.639302480138391*^9, 3.639302534361251*^9}, {3.6393027015415382`*^9, 
   3.639302718461164*^9}, {3.639302785082328*^9, 3.639303018303033*^9}, {
   3.639305437149797*^9, 3.639305449865726*^9}, {3.639305518802198*^9, 
   3.639305519014502*^9}, {3.639305933947773*^9, 3.639305934300606*^9}, {
   3.639305995353513*^9, 3.639306022569894*^9}, 3.6393061553258953`*^9, {
   3.639306290465506*^9, 3.639306290779763*^9}, {3.6393063497904987`*^9, 
   3.639306350747435*^9}, {3.6393072377839727`*^9, 3.639307238643078*^9}, {
   3.639307458391555*^9, 3.639307466495369*^9}, {3.639307509675352*^9, 
   3.639307509911058*^9}, {3.6393078158593473`*^9, 3.639307867055065*^9}, {
   3.639308541527812*^9, 3.639308541764086*^9}, {3.639308589974814*^9, 
   3.639308624692738*^9}, {3.639308709699504*^9, 3.63930870988833*^9}, {
   3.6393087775414867`*^9, 3.6393087808398457`*^9}, {3.639309018679047*^9, 
   3.639309023283306*^9}, {3.6393126682746897`*^9, 3.639312682773988*^9}, {
   3.639313093902979*^9, 3.639313123887788*^9}, {3.639313274785696*^9, 
   3.639313315802662*^9}, {3.639313414609424*^9, 3.639313420840898*^9}, {
   3.639314127635388*^9, 3.639314127920916*^9}, {3.6393145055780077`*^9, 
   3.639314610381082*^9}, {3.6393147168776197`*^9, 3.6393148198980207`*^9}, {
   3.639314859269022*^9, 3.639314859803797*^9}, {3.639314894737595*^9, 
   3.639314909336363*^9}, {3.639314953654141*^9, 3.639314956665535*^9}, {
   3.639315354084749*^9, 3.639315354629163*^9}, {3.639315407423287*^9, 
   3.63931540794461*^9}, {3.6393265300277033`*^9, 3.639326533756289*^9}, {
   3.639327591228373*^9, 3.639327612125977*^9}, {3.6393289832237*^9, 
   3.639328984894271*^9}, {3.6393291692191896`*^9, 3.6393291731816273`*^9}, {
   3.639330745722433*^9, 3.6393307512365913`*^9}, {3.6393314260701113`*^9, 
   3.639331426218782*^9}, {3.639333165317617*^9, 3.6393331790991287`*^9}, {
   3.6393841585739393`*^9, 3.639384158670869*^9}, {3.639384191285946*^9, 
   3.639384212235729*^9}, {3.639384253503276*^9, 3.639384272855797*^9}, {
   3.639384312477126*^9, 3.6393843510229177`*^9}, {3.639384933549797*^9, 
   3.639384933607205*^9}, {3.639385049139201*^9, 3.63938506048569*^9}, {
   3.6393852832213287`*^9, 3.639385294090139*^9}, {3.639385345207466*^9, 
   3.639385345299693*^9}, {3.639387573866659*^9, 3.639387574598542*^9}, {
   3.6393876445085583`*^9, 3.639387644927718*^9}, {3.6394211316036463`*^9, 
   3.639421135230335*^9}, {3.639422934845027*^9, 3.639422935280756*^9}, 
   3.639481687346161*^9, 3.6394817771843243`*^9, {3.639482958988761*^9, 
   3.6394829648764257`*^9}, {3.639483473396893*^9, 3.639483492309408*^9}, {
   3.639483549599128*^9, 3.63948355677179*^9}}],

Cell[BoxData[
 RowBox[{"Data", " ", "Stock"}]], "Output",
 CellChangeTimes->{{3.639301859665298*^9, 3.6393018644901037`*^9}, {
   3.639301974190961*^9, 3.639301996256754*^9}, {3.6393023760163403`*^9, 
   3.639302420215407*^9}, 3.639302483755946*^9, {3.6393025260405693`*^9, 
   3.639302535327207*^9}, {3.639302796962029*^9, 3.6393028502431602`*^9}, {
   3.639302883715176*^9, 3.6393029207465963`*^9}, {3.6393029962237167`*^9, 
   3.6393030064674883`*^9}, 3.639305450498335*^9, 3.639305523881008*^9, 
   3.639306172522728*^9, 3.639306401186561*^9, 3.639307336064309*^9, 
   3.639307377710259*^9, 3.6393074683025827`*^9, 3.6393075695251513`*^9, {
   3.6393078235792627`*^9, 3.639307868045302*^9}, 3.6393085433113413`*^9, 
   3.639308626388081*^9, 3.639308715309992*^9, 3.639308783536446*^9, {
   3.639312677114149*^9, 3.639312683363263*^9}, {3.639313095786344*^9, 
   3.6393131269114723`*^9}, 3.639313168699972*^9, 3.639313283766283*^9, 
   3.6393133169335833`*^9, {3.639313421556841*^9, 3.639313441355784*^9}, 
   3.639314130291254*^9, 3.639314162882523*^9, 3.639314196674416*^9, {
   3.639314508542508*^9, 3.63931461164961*^9}, {3.639314738314741*^9, 
   3.639314820501873*^9}, 3.63931486032609*^9, {3.639314895458346*^9, 
   3.6393149212846527`*^9}, 3.639315408821526*^9, 3.6393265358066196`*^9, {
   3.639327596082115*^9, 3.639327612621426*^9}, 3.639328985670515*^9, 
   3.639329173929081*^9, 3.6393294876239243`*^9, {3.63933074745725*^9, 
   3.63933075162836*^9}, 3.639330987250695*^9, 3.639331426853785*^9, {
   3.63933317591182*^9, 3.6393331795865993`*^9}, {3.639384152511649*^9, 
   3.6393841592874403`*^9}, {3.6393841927260323`*^9, 3.639384206807643*^9}, {
   3.639384257319615*^9, 3.639384283778561*^9}, {3.639384330876401*^9, 
   3.6393843513619223`*^9}, {3.639384461580447*^9, 3.639384469401099*^9}, 
   3.639384601823175*^9, 3.639384684731182*^9, 3.6393849348798733`*^9, {
   3.639385052852964*^9, 3.63938506150224*^9}, 3.639385296622424*^9, 
   3.639385345834155*^9, 3.639387419106512*^9, 3.6393875212821417`*^9, 
   3.639387575327758*^9, 3.639387645529807*^9, 3.639414968465369*^9, 
   3.6394210874994287`*^9, 3.639421135863529*^9, 3.6394229361257133`*^9, 
   3.639483473952318*^9, {3.639483550260244*^9, 3.63948355706079*^9}}],

Cell[BoxData["108"], "Output",
 CellChangeTimes->{{3.639301859665298*^9, 3.6393018644901037`*^9}, {
   3.639301974190961*^9, 3.639301996256754*^9}, {3.6393023760163403`*^9, 
   3.639302420215407*^9}, 3.639302483755946*^9, {3.6393025260405693`*^9, 
   3.639302535327207*^9}, {3.639302796962029*^9, 3.6393028502431602`*^9}, {
   3.639302883715176*^9, 3.6393029207465963`*^9}, {3.6393029962237167`*^9, 
   3.6393030064674883`*^9}, 3.639305450498335*^9, 3.639305523881008*^9, 
   3.639306172522728*^9, 3.639306401186561*^9, 3.639307336064309*^9, 
   3.639307377710259*^9, 3.6393074683025827`*^9, 3.6393075695251513`*^9, {
   3.6393078235792627`*^9, 3.639307868045302*^9}, 3.6393085433113413`*^9, 
   3.639308626388081*^9, 3.639308715309992*^9, 3.639308783536446*^9, {
   3.639312677114149*^9, 3.639312683363263*^9}, {3.639313095786344*^9, 
   3.6393131269114723`*^9}, 3.639313168699972*^9, 3.639313283766283*^9, 
   3.6393133169335833`*^9, {3.639313421556841*^9, 3.639313441355784*^9}, 
   3.639314130291254*^9, 3.639314162882523*^9, 3.639314196674416*^9, {
   3.639314508542508*^9, 3.63931461164961*^9}, {3.639314738314741*^9, 
   3.639314820501873*^9}, 3.63931486032609*^9, {3.639314895458346*^9, 
   3.6393149212846527`*^9}, 3.639315408821526*^9, 3.6393265358066196`*^9, {
   3.639327596082115*^9, 3.639327612621426*^9}, 3.639328985670515*^9, 
   3.639329173929081*^9, 3.6393294876239243`*^9, {3.63933074745725*^9, 
   3.63933075162836*^9}, 3.639330987250695*^9, 3.639331426853785*^9, {
   3.63933317591182*^9, 3.6393331795865993`*^9}, {3.639384152511649*^9, 
   3.6393841592874403`*^9}, {3.6393841927260323`*^9, 3.639384206807643*^9}, {
   3.639384257319615*^9, 3.639384283778561*^9}, {3.639384330876401*^9, 
   3.6393843513619223`*^9}, {3.639384461580447*^9, 3.639384469401099*^9}, 
   3.639384601823175*^9, 3.639384684731182*^9, 3.6393849348798733`*^9, {
   3.639385052852964*^9, 3.63938506150224*^9}, 3.639385296622424*^9, 
   3.639385345834155*^9, 3.639387419106512*^9, 3.6393875212821417`*^9, 
   3.639387575327758*^9, 3.639387645529807*^9, 3.639414968465369*^9, 
   3.6394210874994287`*^9, 3.639421135863529*^9, 3.6394229361257133`*^9, 
   3.639483473952318*^9, {3.639483550260244*^9, 3.639483557194324*^9}}],

Cell[BoxData[
 TemplateBox[{GraphicsBox[{{}, {{{}, {}, {
        Hue[0.67, 0.6, 0.6], 
        Directive[
         PointSize[0.01388888888888889], 
         RGBColor[0.368417, 0.506779, 0.709798], 
         AbsoluteThickness[1.6]], 
        LineBox[CompressedData["
1:eJxdk01IVFEYhi+tgjYRIkUWJmIhIqWmpZXHn8lGZ8a5d34dF4WoBBkSQUFU
XKpFqxYFgbugFgVG2K120bWilbSoKKFNKwmiP+hnFVT3Oe8FR5CPZ97vfc/3
nZmzbWLWm1rjOM7Mv///lb9vvaXxhSepl/eN/YD6VbyW+kK83kT9y+Iak/e2
39j0S7zR3LmVMcFHcR38Slwf9c/dEzeQF4obI156I27C/0W8w8zfXT688k7c
jD/Ob8Ef57WiPxPvjKq/JN4V5bd/ErexT7x/e3Te9E9xB/kfxLvJ/yHuJK85
sNwFd4j30N8i3ss8aXE3+SfFPegXxfuY57x4P/Wy+ADnPRD3krcgNtzfU8u+
of+x9D7yF6X3oYudfvKeS+8n77b0AeY9K32A+5yRPoj/ivRB+o9KT8Dax0/Q
70s/CF+XDqfmpQ8x703pQ8x3Vfoh5rkk3fKE9CR8SnqSOit9mPx4vmF+z0np
I/i7pY8wX4/0FPslpKfQY3+a+2+VnqZfeU5mNftV7IxSu6SP8n4apWfJ32rZ
ZKlt6s/SX285pH8lI7+LPye/Sz0hv4v/tPwu+x2X3+P+PPk9vs8j8nvku/J7
3O9m+XPc73v73gw899uyn6O+tRxa/bXeZ555vsufZz9H5+e5z8/yo08/lL/A
/I/kh4NFnV/FYYHz/shfJH+D9i+iN+n8IvN0an+r6/fglJinTn7L6+Qv0b9F
/hLn1cpfZv4a+cvoDfKXySvIT38Qv48xvq9j8ls+J/8YeXo/oWX1OxX2uyB/
hXnPyF/FYYU6Kf849Vpg/gJe+ciO
         "]]}}}, {}}, {
    DisplayFunction -> Identity, PlotRangePadding -> {{
        Scaled[0.02], 
        Scaled[0.02]}, {
        Scaled[0.05], 
        Scaled[0.05]}}, AxesOrigin -> {0, 4769.740115}, 
     PlotRange -> {{0., 108.}, {4783.6001, 5060.7998}}, DisplayFunction -> 
     Identity, AspectRatio -> NCache[GoldenRatio^(-1), 0.6180339887498948], 
     Axes -> {True, True}, AxesLabel -> {None, None}, 
     AxesOrigin -> {0, 4769.740115}, DisplayFunction :> Identity, 
     Frame -> {{False, False}, {False, False}}, 
     FrameLabel -> {{None, None}, {None, None}}, 
     FrameTicks -> {{Automatic, Automatic}, {Automatic, Automatic}}, 
     GridLines -> {None, None}, GridLinesStyle -> Directive[
       GrayLevel[0.5, 0.4]], Method -> {}, 
     PlotRange -> {{0., 108.}, {4783.6001, 5060.7998}}, PlotRangeClipping -> 
     True, PlotRangePadding -> {{
        Scaled[0.02], 
        Scaled[0.02]}, {
        Scaled[0.05], 
        Scaled[0.05]}}, Ticks -> {Automatic, Automatic}}],FormBox[
    FormBox[
     TemplateBox[{"\"HSI\""}, "LineLegend", DisplayFunction -> (FormBox[
        StyleBox[
         StyleBox[
          PaneBox[
           TagBox[
            GridBox[{{
               TagBox[
                GridBox[{{
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.25], 
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[1.6]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.25], 
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[1.6]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #}}, 
                 GridBoxAlignment -> {
                  "Columns" -> {Center, Left}, "Rows" -> {{Baseline}}}, 
                 AutoDelete -> False, 
                 GridBoxDividers -> {
                  "Columns" -> {{False}}, "Rows" -> {{False}}}, 
                 GridBoxItemSize -> {"Columns" -> {{All}}, "Rows" -> {{All}}},
                  GridBoxSpacings -> {
                  "Columns" -> {{0.5}}, "Rows" -> {{0.8}}}], "Grid"]}}, 
             GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
             AutoDelete -> False, 
             GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{1}}, "Rows" -> {{0}}}], 
            "Grid"], Alignment -> Left, AppearanceElements -> None, 
           ImageMargins -> {{5, 5}, {5, 5}}, ImageSizeAction -> 
           "ResizeToFit"], LineIndent -> 0, StripOnInput -> False], {
         FontFamily -> "Arial"}, Background -> Automatic, StripOnInput -> 
         False], TraditionalForm]& ), 
      InterpretationFunction :> (RowBox[{"LineLegend", "[", 
         RowBox[{
           RowBox[{"{", 
             RowBox[{"Directive", "[", 
               RowBox[{
                 RowBox[{"PointSize", "[", "0.01388888888888889`", "]"}], ",", 
                 InterpretationBox[
                  ButtonBox[
                   TooltipBox[
                    RowBox[{
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    RectangleBox[{0, -1}, {2, 1}]}}, AspectRatio -> 1, Frame -> 
                    True, FrameStyle -> 
                    RGBColor[
                    0.24561133333333335`, 0.3378526666666667, 
                    0.4731986666666667], FrameTicks -> None, PlotRangePadding -> 
                    None, ImageSize -> 
                    Dynamic[{
                    Automatic, 1.35 CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification]}]], 
                    "\[InvisibleSpace]"}], 
                    "RGBColor[0.368417, 0.506779, 0.709798]"], Appearance -> 
                   None, BaseStyle -> {}, BaselinePosition -> Baseline, 
                   DefaultBaseStyle -> {}, ButtonFunction :> 
                   With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[0.368417, 0.506779, 0.709798]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                   Automatic, Method -> "Preemptive"], 
                  RGBColor[0.368417, 0.506779, 0.709798], Editable -> False, 
                  Selectable -> False], ",", 
                 RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}], 
             "}"}], ",", 
           RowBox[{"{", #, "}"}], ",", 
           RowBox[{"Joined", "\[Rule]", 
             RowBox[{"{", 
               RowBox[{"{", "True", "}"}], "}"}]}], ",", 
           RowBox[{"LabelStyle", "\[Rule]", 
             RowBox[{"{", "}"}]}], ",", 
           RowBox[{"LegendLayout", "\[Rule]", "\"Column\""}], ",", 
           RowBox[{"LegendMarkers", "\[Rule]", 
             RowBox[{"{", 
               RowBox[{"{", 
                 RowBox[{"False", ",", "Automatic"}], "}"}], "}"}]}]}], 
         "]"}]& ), Editable -> True], TraditionalForm], TraditionalForm]},
  "Legended",
  DisplayFunction->(GridBox[{{
      TagBox[
       ItemBox[
        PaneBox[
         TagBox[#, "SkipImageSizeLevel"], Alignment -> {Center, Baseline}, 
         BaselinePosition -> Baseline], DefaultBaseStyle -> "Labeled"], 
       "SkipImageSizeLevel"], 
      ItemBox[#2, DefaultBaseStyle -> "LabeledLabel"]}}, 
    GridBoxAlignment -> {"Columns" -> {{Center}}, "Rows" -> {{Center}}}, 
    AutoDelete -> False, GridBoxItemSize -> Automatic, 
    BaselinePosition -> {1, 1}]& ),
  Editable->True,
  InterpretationFunction->(RowBox[{"Legended", "[", 
     RowBox[{#, ",", 
       RowBox[{"Placed", "[", 
         RowBox[{#2, ",", "After"}], "]"}]}], "]"}]& )]], "Output",
 CellChangeTimes->{{3.639301859665298*^9, 3.6393018644901037`*^9}, {
   3.639301974190961*^9, 3.639301996256754*^9}, {3.6393023760163403`*^9, 
   3.639302420215407*^9}, 3.639302483755946*^9, {3.6393025260405693`*^9, 
   3.639302535327207*^9}, {3.639302796962029*^9, 3.6393028502431602`*^9}, {
   3.639302883715176*^9, 3.6393029207465963`*^9}, {3.6393029962237167`*^9, 
   3.6393030064674883`*^9}, 3.639305450498335*^9, 3.639305523881008*^9, 
   3.639306172522728*^9, 3.639306401186561*^9, 3.639307336064309*^9, 
   3.639307377710259*^9, 3.6393074683025827`*^9, 3.6393075695251513`*^9, {
   3.6393078235792627`*^9, 3.639307868045302*^9}, 3.6393085433113413`*^9, 
   3.639308626388081*^9, 3.639308715309992*^9, 3.639308783536446*^9, {
   3.639312677114149*^9, 3.639312683363263*^9}, {3.639313095786344*^9, 
   3.6393131269114723`*^9}, 3.639313168699972*^9, 3.639313283766283*^9, 
   3.6393133169335833`*^9, {3.639313421556841*^9, 3.639313441355784*^9}, 
   3.639314130291254*^9, 3.639314162882523*^9, 3.639314196674416*^9, {
   3.639314508542508*^9, 3.63931461164961*^9}, {3.639314738314741*^9, 
   3.639314820501873*^9}, 3.63931486032609*^9, {3.639314895458346*^9, 
   3.6393149212846527`*^9}, 3.639315408821526*^9, 3.6393265358066196`*^9, {
   3.639327596082115*^9, 3.639327612621426*^9}, 3.639328985670515*^9, 
   3.639329173929081*^9, 3.6393294876239243`*^9, {3.63933074745725*^9, 
   3.63933075162836*^9}, 3.639330987250695*^9, 3.639331426853785*^9, {
   3.63933317591182*^9, 3.6393331795865993`*^9}, {3.639384152511649*^9, 
   3.6393841592874403`*^9}, {3.6393841927260323`*^9, 3.639384206807643*^9}, {
   3.639384257319615*^9, 3.639384283778561*^9}, {3.639384330876401*^9, 
   3.6393843513619223`*^9}, {3.639384461580447*^9, 3.639384469401099*^9}, 
   3.639384601823175*^9, 3.639384684731182*^9, 3.6393849348798733`*^9, {
   3.639385052852964*^9, 3.63938506150224*^9}, 3.639385296622424*^9, 
   3.639385345834155*^9, 3.639387419106512*^9, 3.6393875212821417`*^9, 
   3.639387575327758*^9, 3.639387645529807*^9, 3.639414968465369*^9, 
   3.6394210874994287`*^9, 3.639421135863529*^9, 3.6394229361257133`*^9, 
   3.639483473952318*^9, {3.639483550260244*^9, 3.639483557268684*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  StyleBox["Predictors", "Title"], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sampleSize", "=", "40"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"windowSize", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"methods", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
     "\"\<NearestNeighbors\>\"", ",", " ", "\"\<NeuralNetwork\>\"", ",", " ", 
      "\"\<RandomForest\>\"", ",", " ", "\"\<LinearRegression\>\""}], "}"}]}],
    ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"methods", " ", "=", " ", 
     RowBox[{"{", "\"\<NeuralNetwork\>\"", "}"}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"iterations", " ", "=", " ", "sampleSize"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetSharedVariable", "[", "iterations", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"predictedPrices", " ", "=", " ", 
   RowBox[{"Monitor", "[", 
    RowBox[{
     RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"iterations", "++"}], ";", "\[IndentingNewLine]", 
        RowBox[{"patterns", " ", "=", " ", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"priceChanges", "[", 
             RowBox[{"[", 
              RowBox[{"j", ";;", 
               RowBox[{"j", "+", "windowSize", "-", "1"}]}], "]"}], "]"}], 
            "\[Rule]", 
            RowBox[{"priceChanges", "[", 
             RowBox[{"[", 
              RowBox[{"j", "+", "windowSize"}], "]"}], "]"}]}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"j", ",", " ", 
             RowBox[{"i", "-", "sampleSize", "+", "1"}], ",", 
             RowBox[{"i", "-", "windowSize"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"trainingPatterns", " ", "=", " ", 
         RowBox[{"patterns", "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", 
            RowBox[{"-", "2"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"testPatterns", " ", "=", " ", 
         RowBox[{"patterns", "[", 
          RowBox[{"[", 
           RowBox[{"-", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"predictors", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Predict", "[", 
            RowBox[{"trainingPatterns", ",", " ", 
             RowBox[{"Method", " ", "\[Rule]", "#"}], ",", " ", 
             RowBox[{"PerformanceGoal", "\[Rule]", "\"\<Quality\>\""}]}], 
            "]"}], "&"}], "/@", "  ", "methods"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"If", " ", "[", 
           RowBox[{
            RowBox[{"i", " ", "\[Equal]", " ", "sampleSize"}], ",", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{"PredictorInformation", "[", "#", "]"}], "]"}], " ", 
              "&"}], " ", "/@", " ", "predictors"}]}], "]"}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"Keys", "[", "testPatterns", "]"}], "]"}], "  ", "*", " ", 
           RowBox[{"allBeforeRealPrices", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], " ", "&"}], " ", "/@", "  ", 
         "predictors"}]}], "\[IndentingNewLine]", ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", "sampleSize", ",", 
         RowBox[{"Length", "[", "priceChanges", "]"}]}], "}"}]}], "]"}], ",", 
     
     RowBox[{"ProgressIndicator", "[", 
      RowBox[{"iterations", ",", " ", 
       RowBox[{"{", 
        RowBox[{"sampleSize", ",", 
         RowBox[{"Length", "[", "priceChanges", "]"}]}], "}"}]}], "]"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"realPrices", " ", "=", " ", 
   RowBox[{"allRealPrices", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Length", "[", "predictedPrices", "]"}]}], ";;", 
      RowBox[{"-", "1"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"beforeRealPrices", " ", "=", " ", 
   RowBox[{"allRealPrices", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Length", "[", "predictedPrices", "]"}]}], "-", "1"}], ";;", 
      RowBox[{"-", "2"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"predictedPricesAllMethods", " ", "=", " ", "predictedPrices"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"methods", ",", "\"\<Naive\>\""}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"predictedPricesAllMethods", " ", "=", " ", 
   RowBox[{
    RowBox[{"Append", "[", 
     RowBox[{
      RowBox[{"predictedPricesAllMethods", "\[Transpose]"}], ",", 
      "beforeRealPrices"}], "]"}], "\[Transpose]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.639302639351822*^9, 3.639302639788286*^9}, {
   3.639303318904319*^9, 3.63930332790415*^9}, {3.639303394337605*^9, 
   3.639303524914612*^9}, {3.639303606413714*^9, 3.63930364788246*^9}, {
   3.639303681057768*^9, 3.6393036917716923`*^9}, {3.63930374699865*^9, 
   3.6393038233939734`*^9}, {3.639303860187368*^9, 3.63930390114093*^9}, {
   3.639303932842737*^9, 3.639303966551724*^9}, {3.63930407241754*^9, 
   3.639304134905808*^9}, {3.639304165517962*^9, 3.6393042366954517`*^9}, {
   3.639304302944544*^9, 3.639304313679422*^9}, {3.6393043669873247`*^9, 
   3.639304592279016*^9}, {3.639304622639957*^9, 3.6393047015247383`*^9}, {
   3.639304732308839*^9, 3.639305020816394*^9}, {3.639305053001966*^9, 
   3.639305194473999*^9}, 3.6393052787793093`*^9, {3.6393054107653008`*^9, 
   3.639305429265347*^9}, {3.639305482483985*^9, 3.6393054931972647`*^9}, {
   3.6393055464244537`*^9, 3.639305549256287*^9}, {3.639305593098781*^9, 
   3.639305753247736*^9}, {3.639305881385582*^9, 3.639305882592334*^9}, {
   3.639305921337908*^9, 3.63930592693792*^9}, {3.639306027318001*^9, 
   3.639306100380043*^9}, {3.63930615783666*^9, 3.639306278727159*^9}, {
   3.639306316962873*^9, 3.639306355444783*^9}, 3.639307520619192*^9, {
   3.639307624871233*^9, 3.63930762584724*^9}, {3.639307681427466*^9, 
   3.639307691714141*^9}, {3.639307736886166*^9, 3.639307737573299*^9}, {
   3.6393078826724358`*^9, 3.63930788369692*^9}, {3.6393079195748177`*^9, 
   3.639307923870119*^9}, {3.6393079934719543`*^9, 3.639307993568211*^9}, {
   3.639308117263754*^9, 3.639308304987617*^9}, {3.639308450674521*^9, 
   3.6393084515768948`*^9}, {3.639308495707758*^9, 3.639308499394157*^9}, {
   3.639308537726284*^9, 3.639308539027495*^9}, {3.6393086714333773`*^9, 
   3.639308672136149*^9}, 3.6393087272321978`*^9, {3.6393088630273533`*^9, 
   3.6393088873284473`*^9}, {3.639308970484923*^9, 3.639308988893338*^9}, {
   3.639309043886277*^9, 3.639309045165601*^9}, {3.639309075613531*^9, 
   3.639309214510051*^9}, {3.63930927218476*^9, 3.6393095181550093`*^9}, {
   3.639309572443969*^9, 3.639309577754456*^9}, {3.639309617377301*^9, 
   3.639309679467679*^9}, {3.639309711506971*^9, 3.639309784810856*^9}, {
   3.639309957000609*^9, 3.639309964064227*^9}, {3.6393103365111227`*^9, 
   3.639310348447061*^9}, {3.639310639593882*^9, 3.639310642657853*^9}, {
   3.6393107336849833`*^9, 3.639310733812648*^9}, {3.639311527382782*^9, 
   3.639311540449951*^9}, {3.639312003272717*^9, 3.639312016377872*^9}, {
   3.63931209288701*^9, 3.639312100422309*^9}, {3.6393123420544643`*^9, 
   3.639312348265819*^9}, {3.63931259962953*^9, 3.639312602395903*^9}, {
   3.639312654273765*^9, 3.6393126627592916`*^9}, {3.6393129418539953`*^9, 
   3.6393129419977837`*^9}, {3.639313006811449*^9, 3.639313006879146*^9}, {
   3.63932648746663*^9, 3.639326489016946*^9}, {3.639327617415246*^9, 
   3.639327617693534*^9}, {3.6393282073276176`*^9, 3.639328209357647*^9}, {
   3.639329479258812*^9, 3.639329479378211*^9}, {3.639330991321507*^9, 
   3.639330992608869*^9}, {3.639386792123632*^9, 3.639386797412517*^9}, {
   3.639386838449286*^9, 3.639386838680189*^9}, {3.63938734533405*^9, 
   3.6393873571894417`*^9}, {3.639387389728524*^9, 3.639387408226169*^9}, {
   3.639387484527886*^9, 3.6393875513032093`*^9}, {3.6393876015994043`*^9, 
   3.6393876228316307`*^9}, {3.639387669595191*^9, 3.639387671153927*^9}, {
   3.639387753256773*^9, 3.639387769008007*^9}, {3.6394149352534847`*^9, 
   3.639414935346854*^9}, {3.6394210961079884`*^9, 3.639421108883497*^9}, 
   3.639421179687042*^9, {3.639421246799255*^9, 3.6394212574907093`*^9}, {
   3.6394218248283157`*^9, 3.639421830059964*^9}, {3.639482972661294*^9, 
   3.639482973773301*^9}, {3.6394830321289062`*^9, 3.639483032554599*^9}, {
   3.639483065805765*^9, 3.639483114587779*^9}, {3.639483156612276*^9, 
   3.63948319559669*^9}, {3.639483237771079*^9, 3.639483418159377*^9}, 
   3.639483468163784*^9, {3.6394835747661343`*^9, 3.639483583901441*^9}, {
   3.639483614355476*^9, 3.6394836147124977`*^9}, {3.639483655660782*^9, 
   3.639483657579376*^9}, {3.639483883722186*^9, 3.639483884233877*^9}}],

Cell[BoxData["Predictors"], "Output",
 CellChangeTimes->{{3.639483477255005*^9, 3.6394834984636717`*^9}, {
   3.639483561229218*^9, 3.639483588313443*^9}, 3.639483621829064*^9, 
   3.639483658328075*^9, 3.6394838847521973`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  StyleBox[
   RowBox[{"Predictor", " ", "results"}], "Title"], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"measures", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", " ", 
    RowBox[{"i", " ", "\[LessEqual]", 
     RowBox[{"Length", "[", "methods", "]"}]}], ",", " ", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"predictedPrices", " ", "=", " ", 
      RowBox[{"predictedPricesAllMethods", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "i"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]",
      "\[IndentingNewLine]", 
     RowBox[{"mae", " ", "=", " ", 
      RowBox[{
       RowBox[{"Total", "[", 
        RowBox[{"Abs", "[", " ", 
         RowBox[{"predictedPrices", "-", "realPrices"}], "]"}], "]"}], " ", 
       "/", " ", 
       RowBox[{"Length", "[", "realPrices", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"mape", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Total", "[", 
         RowBox[{"Abs", "[", " ", 
          RowBox[{
           RowBox[{"predictedPrices", "/", "realPrices"}], "-", "1"}], "]"}], 
         "]"}], " ", "/", " ", 
        RowBox[{"Length", "[", "realPrices", "]"}]}], "*", "100"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"movementAccuracy", " ", "=", " ", 
      RowBox[{
       RowBox[{"Total", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Sign", "[", 
             RowBox[{"predictedPrices", "-", "beforeRealPrices"}], "]"}], " ",
             "*", " ", 
            RowBox[{"Sign", "[", 
             RowBox[{"realPrices", "-", "beforeRealPrices"}], "]"}]}], "+", 
           "1"}], ")"}], "/", "2"}], "]"}], " ", "/", " ", 
       RowBox[{"Length", "[", "realPrices", "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"money", " ", "=", " ", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", " ", "[", 
      RowBox[{
       RowBox[{"t", " ", "=", " ", "2"}], ",", " ", 
       RowBox[{"t", " ", "\[LessEqual]", 
        RowBox[{"Length", "[", "predictedPrices", "]"}]}], ",", " ", 
       RowBox[{"t", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"If", " ", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"predictedPrices", "[", 
           RowBox[{"[", "t", "]"}], "]"}], " ", "\[GreaterEqual]", 
          RowBox[{"realPrices", "[", 
           RowBox[{"[", 
            RowBox[{"t", "-", "1"}], "]"}], "]"}]}], ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"money", " ", "*=", " ", 
           RowBox[{
            RowBox[{"realPrices", "[", 
             RowBox[{"[", "t", "]"}], "]"}], " ", "/", " ", 
            RowBox[{"realPrices", "[", 
             RowBox[{"[", 
              RowBox[{"t", "-", "1"}], "]"}], "]"}]}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"moneyNoFees", " ", "=", " ", "money"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"money", " ", "=", " ", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"hasInvested", " ", "=", " ", "True"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"For", " ", "[", 
       RowBox[{
        RowBox[{"t", " ", "=", " ", "2"}], ",", " ", 
        RowBox[{"t", " ", "\[LessEqual]", 
         RowBox[{"Length", "[", "predictedPrices", "]"}]}], ",", " ", 
        RowBox[{"t", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"transactionFee", " ", "=", " ", 
          RowBox[{"money", " ", "*", " ", 
           RowBox[{"0.14", " ", "/", " ", "100"}]}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", " ", "[", 
          RowBox[{"hasInvested", ",", "\[IndentingNewLine]", 
           RowBox[{"If", " ", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"predictedPrices", "[", 
                RowBox[{"[", "t", "]"}], "]"}], " ", "+", " ", 
               "transactionFee"}], " ", "<", 
              RowBox[{"realPrices", "[", 
               RowBox[{"[", 
                RowBox[{"t", "-", "1"}], "]"}], "]"}]}], ",", "  ", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"money", " ", "-=", " ", "transactionFee"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"hasInvested", "=", "False"}], ";"}], 
             "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"money", " ", "*=", " ", 
               RowBox[{
                RowBox[{"realPrices", "[", 
                 RowBox[{"[", "t", "]"}], "]"}], " ", "/", " ", 
                RowBox[{"realPrices", "[", 
                 RowBox[{"[", 
                  RowBox[{"t", "-", "1"}], "]"}], "]"}]}]}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
           "\[IndentingNewLine]", 
           RowBox[{"If", " ", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"predictedPrices", "[", 
                RowBox[{"[", "t", "]"}], "]"}], " ", "-", " ", 
               "transactionFee"}], " ", "\[GreaterEqual]", 
              RowBox[{"realPrices", "[", 
               RowBox[{"[", 
                RowBox[{"t", "-", "1"}], "]"}], "]"}]}], ",", "  ", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"money", " ", "=", " ", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"money", "-", "transactionFee"}], ")"}], "*", 
                RowBox[{
                 RowBox[{"realPrices", "[", 
                  RowBox[{"[", "t", "]"}], "]"}], " ", "/", " ", 
                 RowBox[{"realPrices", "[", 
                  RowBox[{"[", 
                   RowBox[{"t", "-", "1"}], "]"}], "]"}]}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"hasInvested", "=", "True"}], ";"}]}], 
            "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], 
         ";"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], 
      "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"measures", ",", 
        RowBox[{"{", 
         RowBox[{
         "mae", ",", " ", "mape", ",", " ", "moneyNoFees", ",", " ", "money", 
          ",", " ", 
          RowBox[{"N", "[", "movementAccuracy", "]"}]}], "}"}]}], "]"}]}]}]}],
    "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"table", " ", "=", " ", 
  RowBox[{"TableForm", "[", 
   RowBox[{"measures", ",", 
    RowBox[{"TableHeadings", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"methods", ",", " ", 
       RowBox[{"{", 
        RowBox[{
        "\"\<MAE\>\"", ",", " ", "\"\<MAPE\>\"", ",", " ", 
         "\"\<Investment profit no fees\>\"", ",", " ", 
         "\"\<Investment profit\>\"", ",", " ", "\"\<Movement accuracy\>\""}],
         "}"}]}], "}"}]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<tidilua.tex\>\"", ",", " ", "table"}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"funcs", "=", 
    RowBox[{"predictedPricesAllMethods", "\[Transpose]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Manipulate", "[", 
    RowBox[{
     RowBox[{"ListLinePlot", "[", "fs", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"fs", ",", "funcs", ",", 
       RowBox[{"ControlType", "\[Rule]", "TogglerBar"}]}], "}"}]}], "]"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Manipulate", "[", 
   RowBox[{
    RowBox[{"ListLinePlot", "[", 
     RowBox[{
      RowBox[{"funcs", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Position", "[", 
            RowBox[{"methods", ",", " ", "#"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "&"}], " ", "/@", " ",
          "x"}], "]"}], "]"}], ",", " ", 
      RowBox[{"PlotLegends", "\[Rule]", "x"}]}], "]"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", " ", 
        RowBox[{"{", "\"\<Naive\>\"", "}"}], ",", " ", "\"\<zebra\>\""}], 
       "}"}], ",", "methods", ",", " ", 
      RowBox[{"ControlType", "\[Rule]", "TogglerBar"}]}], "}"}]}], "]"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"ListLinePlot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"realPrices", ",", " ", 
       RowBox[{"predictedPricesAllMethods", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", " ", 
       RowBox[{"predictedPricesAllMethods", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", " ", 
       RowBox[{"predictedPricesAllMethods", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "3"}], "]"}], "]"}], ",", " ", 
       RowBox[{"predictedPricesAllMethods", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "4"}], "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"PlotLegends", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<Real prices\>\"", ",", " ", "\"\<Predicted Prices\>\""}], 
       "}"}]}]}], "]"}], "*)"}], "\[IndentingNewLine]"}], "\n"}], "Input",
 CellChangeTimes->{{3.639308375776013*^9, 3.6393084395766172`*^9}, {
   3.639308478386278*^9, 3.639308484230022*^9}, {3.639308834971859*^9, 
   3.639308843557012*^9}, {3.639308894401366*^9, 3.639308925652276*^9}, 
   3.639308968860968*^9, {3.639309833961916*^9, 3.639309847497465*^9}, {
   3.6393099830820417`*^9, 3.639310077532445*^9}, {3.639310114133486*^9, 
   3.639310141254558*^9}, {3.6393102128048487`*^9, 3.639310283828279*^9}, 
   3.6393103183939342`*^9, {3.639310370198224*^9, 3.639310425241407*^9}, {
   3.639310520423923*^9, 3.6393105471465607`*^9}, {3.639310617203619*^9, 
   3.639310637248555*^9}, {3.639310673005175*^9, 3.6393107055053463`*^9}, {
   3.639310773791362*^9, 3.639311258663476*^9}, {3.639311302688168*^9, 
   3.639311342352627*^9}, {3.6393113804123173`*^9, 3.639311513037754*^9}, {
   3.6393115966335487`*^9, 3.639311745830323*^9}, {3.639311788479826*^9, 
   3.639311827468862*^9}, {3.639311882795429*^9, 3.6393119322989273`*^9}, {
   3.6393119700073557`*^9, 3.639311996301506*^9}, {3.639312150431155*^9, 
   3.639312321736104*^9}, {3.63931235802431*^9, 3.639312370706019*^9}, {
   3.639312442356002*^9, 3.639312442742838*^9}, {3.639312574868527*^9, 
   3.639312577013076*^9}, {3.639312796806632*^9, 3.639312814471046*^9}, 
   3.639315685124283*^9, {3.6393157235923367`*^9, 3.639315724846878*^9}, {
   3.639315758830103*^9, 3.639315899404414*^9}, {3.6393270163111153`*^9, 
   3.6393270519058723`*^9}, {3.639327082015224*^9, 3.6393270991127977`*^9}, {
   3.6393271826821527`*^9, 3.639327262711204*^9}, {3.639327317984795*^9, 
   3.639327321722581*^9}, 3.639386859477049*^9, {3.639387271395067*^9, 
   3.639387321653275*^9}, {3.639421865535125*^9, 3.639421887343013*^9}, 
   3.6394219308916283`*^9, {3.639421964544243*^9, 3.639422168486739*^9}, {
   3.639422203190096*^9, 3.639422203428009*^9}, {3.639422235438696*^9, 
   3.639422297332337*^9}, {3.639422341665393*^9, 3.6394225114281893`*^9}, {
   3.639422548170969*^9, 3.6394225910827227`*^9}, {3.639422647559268*^9, 
   3.639422655830847*^9}, {3.639422730969141*^9, 3.639422745506806*^9}, {
   3.6394228575799227`*^9, 3.639422867162777*^9}, {3.6394818167526627`*^9, 
   3.639481817961203*^9}, {3.63948298014205*^9, 3.639482981342917*^9}, {
   3.639483784873857*^9, 3.639483833458336*^9}, {3.639483969415167*^9, 
   3.639483973939396*^9}, {3.639484282674542*^9, 3.639484342674213*^9}, {
   3.639484373398699*^9, 3.639484422593494*^9}, {3.639484452956255*^9, 
   3.639484616872572*^9}, {3.639484647462123*^9, 3.639485087463098*^9}, {
   3.6394851180898523`*^9, 3.639485119653614*^9}, {3.639485187186225*^9, 
   3.639485209159114*^9}, {3.6394852428286057`*^9, 3.639485249001183*^9}, {
   3.63948528239683*^9, 3.639485357089663*^9}, {3.639485388473773*^9, 
   3.639485410966051*^9}, {3.639485624573728*^9, 3.639485652600708*^9}, {
   3.639485918195084*^9, 3.639486003519938*^9}}],

Cell[BoxData[
 RowBox[{"Predictor", " ", "results"}]], "Output",
 CellChangeTimes->{
  3.639485402607679*^9, {3.639485627172639*^9, 3.639485654046735*^9}, 
   3.639485933625415*^9, {3.639485976519964*^9, 3.639486004208729*^9}}],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      StyleBox["\[Null]",
       ShowStringCharacters->False], 
      TagBox["\<\"MAE\"\>",
       HoldForm], 
      TagBox["\<\"MAPE\"\>",
       HoldForm], 
      TagBox["\<\"Investment profit no fees\"\>",
       HoldForm], 
      TagBox["\<\"Investment profit\"\>",
       HoldForm], 
      TagBox["\<\"Movement accuracy\"\>",
       HoldForm]},
     {
      TagBox["\<\"NearestNeighbors\"\>",
       HoldForm], "21.360061944674204`", "0.4335908859993901`", 
      "0.9756925943222426`", "0.9368461976799632`", "0.4264705882352941`"},
     {
      TagBox["\<\"NeuralNetwork\"\>",
       HoldForm], "21.412148136936835`", "0.4348496255203603`", 
      "0.9721618041647536`", "0.9439768632428787`", "0.4117647058823529`"},
     {
      TagBox["\<\"RandomForest\"\>",
       HoldForm], "23.548044842990212`", "0.47805939330535`", 
      "1.0229123912478497`", "0.9766972755590446`", "0.5147058823529411`"},
     {
      TagBox["\<\"LinearRegression\"\>",
       HoldForm], "20.36442178403457`", "0.4138177732780362`", 
      "0.9892636896610626`", "0.9823582062753531`", "0.45588235294117646`"},
     {
      TagBox["\<\"Naive\"\>",
       HoldForm], "19.538199999999975`", "0.39699732531797083`", 
      "1.0085538895038737`", "1.0085538895038737`", "0.5`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxDividers->{
     "Columns" -> {False, True, {False}, False}, "ColumnsIndexed" -> {}, 
      "Rows" -> {False, True, {False}, False}, "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[2.0999999999999996`]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}],
   {OutputFormsDump`HeadedRows, OutputFormsDump`HeadedColumns}],
  Function[BoxForm`e$, 
   TableForm[
   BoxForm`e$, 
    TableHeadings -> {{
      "NearestNeighbors", "NeuralNetwork", "RandomForest", "LinearRegression",
        "Naive"}, {
      "MAE", "MAPE", "Investment profit no fees", "Investment profit", 
       "Movement accuracy"}}]]]], "Output",
 CellChangeTimes->{
  3.639485402607679*^9, {3.639485627172639*^9, 3.639485654046735*^9}, 
   3.639485933625415*^9, {3.639485976519964*^9, 3.6394860042535057`*^9}}],

Cell[BoxData["\<\"tidilua.tex\"\>"], "Output",
 CellChangeTimes->{
  3.639485402607679*^9, {3.639485627172639*^9, 3.639485654046735*^9}, 
   3.639485933625415*^9, {3.639485976519964*^9, 3.639486004328776*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`x$$ = {
    "Naive", "LinearRegression", "NeuralNetwork", "NearestNeighbors", 
     "RandomForest"}, Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`x$$], {"Naive"}, "zebra"}, {
      "NearestNeighbors", "NeuralNetwork", "RandomForest", "LinearRegression",
        "Naive"}}}, Typeset`size$$ = {511., {111., 116.}}, Typeset`update$$ = 
    0, Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`x$1465743$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`x$$ = {"Naive"}}, 
      "ControllerVariables" :> {
        Hold[$CellContext`x$$, $CellContext`x$1465743$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> ListLinePlot[
        Part[$CellContext`funcs, 
         Map[Part[
           Position[$CellContext`methods, #], 1, 1]& , $CellContext`x$$]], 
        PlotLegends -> $CellContext`x$$], 
      "Specifications" :> {{{$CellContext`x$$, {"Naive"}, "zebra"}, {
         "NearestNeighbors", "NeuralNetwork", "RandomForest", 
          "LinearRegression", "Naive"}, ControlType -> TogglerBar}}, 
      "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{556., {154., 159.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.639485402607679*^9, {3.639485627172639*^9, 3.639485654046735*^9}, 
   3.639485933625415*^9, {3.639485976519964*^9, 3.6394860044718523`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"funcs", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{"methods", ",", " ", "#"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "&"}], " ", "/@", " ", 
      RowBox[{"{", 
       RowBox[{"\"\<Naive\>\"", ",", " ", "\"\<NeuralNetwork\>\""}], "}"}]}], 
     "]"}], "]"}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.639485414676928*^9, 3.639485512240675*^9}, {
  3.6394855726452827`*^9, 3.639485616621737*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Part", "::", "partw"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Part \[NoBreak]\\!\\(1\\)\[NoBreak] of \
\[NoBreak]\\!\\({}\\)\[NoBreak] does not exist. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/partw\\\", ButtonNote -> \
\\\"Part::partw\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.639485613149695*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Part", "::", "pkspec1"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"The expression \[NoBreak]\\!\\({5, \\(\\(\\(\\({}\\)\\) \
\[LeftDoubleBracket] \\(\\(1, 1\\)\\) \[RightDoubleBracket]\\)\\)}\\)\
\[NoBreak] cannot be used as a part specification. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/Part\\\", ButtonNote -> \
\\\"Part::pkspec1\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.639485613211693*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "5015.795561986655`", ",", "4965.386721544223`", ",", 
      "5009.889125349485`", ",", "5000.219392102642`", ",", 
      "5024.48262326069`", ",", "5044.2798983029925`", ",", 
      "5039.170831575324`", ",", "5019.631138352328`", ",", 
      "5002.368835050526`", ",", "4957.983294397176`", ",", 
      "4994.215945875941`", ",", "4975.694239237087`", ",", 
      "5004.8916014582155`", ",", "4939.149670674101`", ",", 
      "4930.469233554428`", ",", "4929.3389499868545`", ",", 
      "4932.135851363339`", ",", "4940.412921203736`", ",", 
      "4908.739178710322`", ",", "4924.733824261413`", ",", 
      "4926.143169932064`", ",", "4923.974146451491`", ",", 
      "4931.029345937113`", ",", "4899.801619597454`", ",", 
      "4898.636637549281`", ",", "4911.2769645911`", ",", 
      "4894.765873933909`", ",", "4930.158769591004`", ",", 
      "4945.0418288561`", ",", "4964.860917607577`", ",", 
      "4982.616250873452`", ",", "4975.6912349241875`", ",", 
      "4951.011089747064`", ",", "4952.978272199898`", ",", 
      "4948.561659947222`", ",", "4899.312436045411`", ",", 
      "4832.604225865859`", ",", "4843.0084730303315`", ",", 
      "4820.679662978531`", ",", "4823.652959792025`", ",", 
      "4837.519838957235`", ",", "4858.369899104707`", ",", 
      "4837.979707885536`", ",", "4787.052773225006`", ",", 
      "4795.622988224555`", ",", "4796.539390302059`", ",", 
      "4805.856530451471`", ",", "4848.65874036477`", ",", 
      "4869.359311304849`", ",", "4890.59298618515`", ",", 
      "4910.53417313803`", ",", "4915.945975677672`", ",", 
      "4885.67898479249`", ",", "4866.889413855945`", ",", 
      "4887.883330546883`", ",", "4886.78116556301`", ",", 
      "4895.1483711456685`", ",", "4894.387223890888`", ",", 
      "4951.2300382499225`", ",", "4963.690221347709`", ",", 
      "4982.784041158536`", ",", "4992.751469408031`", ",", 
      "4988.048132128712`", ",", "4969.546239496332`", ",", 
      "4991.599174080409`", ",", "4989.904389867011`", ",", 
      "4997.008024474674`", ",", "4951.990376877474`"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "5014.801856831189`", ",", "4964.328058623654`", ",", 
      "5008.659078908505`", ",", "4995.748608249525`", ",", 
      "5022.0267211692635`", ",", "5044.301211582017`", ",", 
      "5033.739042992927`", ",", "5015.374095135718`", ",", 
      "4999.537945570452`", ",", "4959.492478615241`", ",", 
      "4988.486669399727`", ",", "4978.630944129279`", ",", 
      "5006.5487657160365`", ",", "4942.972639817166`", ",", 
      "4925.431544411881`", ",", "4926.192497983294`", ",", 
      "4936.634094109417`", ",", "4940.325828237052`", ",", 
      "4912.144903740988`", ",", "4925.1819904398`", ",", 
      "4923.8477227517915`", ",", "4924.0014529128575`", ",", 
      "4920.917737457311`", ",", "4900.964117121941`", ",", 
      "4894.846262389187`", ",", "4906.123206208454`", ",", 
      "4898.099804302728`", ",", "4921.102796350041`", ",", 
      "4944.800303441345`", ",", "4961.0089509909185`", ",", 
      "4981.76683383029`", ",", "4975.471964014113`", ",", 
      "4947.892512001108`", ",", "4953.747188331003`", ",", 
      "4947.158672273177`", ",", "4891.759555487111`", ",", 
      "4826.183218207411`", ",", "4843.762027645894`", ",", 
      "4821.7998438444665`", ",", "4817.364320076074`", ",", 
      "4837.6511791573`", ",", "4859.656937185855`", ",", 
      "4843.132910977117`", ",", "4785.04694165705`", ",", 
      "4784.687230915223`", ",", "4794.88566222333`", ",", 
      "4798.062061417302`", ",", "4847.547498344111`", ",", 
      "4881.471486647092`", ",", "4902.322419486729`", ",", 
      "4918.447137345912`", ",", "4909.467815678859`", ",", 
      "4889.04258699736`", ",", "4871.376547077679`", ",", 
      "4894.318487144519`", ",", "4883.679065945649`", ",", 
      "4882.845613890513`", ",", "4901.768239823473`", ",", 
      "4955.724800654083`", ",", "4968.9946105658755`", ",", 
      "4978.159582822802`", ",", "4997.972921899801`", ",", 
      "4984.11777629455`", ",", "4968.682217027964`", ",", 
      "5003.210860331189`", ",", "4983.88212381855`", ",", 
      "4992.056007884442`", ",", "4951.293603494576`"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "4994.440472139361`", ",", "4974.321260025262`", ",", 
      "5000.774410642702`", ",", "5009.955491448537`", ",", 
      "5044.753587274328`", ",", "5064.220389260149`", ",", 
      "5052.793845258094`", ",", "5030.15398856554`", ",", 
      "4993.118277255877`", ",", "4965.001062052569`", ",", 
      "5010.27727950132`", ",", "4995.206534034496`", ",", 
      "5013.586582508414`", ",", "4934.499744086776`", ",", 
      "4914.19455683332`", ",", "4920.499263428948`", ",", 
      "4934.534793477612`", ",", "4921.367871348726`", ",", 
      "4897.538212504247`", ",", "4924.714889232473`", ",", 
      "4928.698909083085`", ",", "4925.781039739367`", ",", 
      "4930.363824291186`", ",", "4913.294324435416`", ",", 
      "4911.088478194095`", ",", "4908.683813619152`", ",", 
      "4902.7052911837745`", ",", "4921.814962225304`", ",", 
      "4940.421697987881`", ",", "4953.440488793526`", ",", 
      "4994.088818805386`", ",", "4967.042069768331`", ",", 
      "4946.926894973681`", ",", "4958.961750903139`", ",", 
      "4936.797774515632`", ",", "4884.315493877405`", ",", 
      "4794.5941922521615`", ",", "4847.79877889335`", ",", 
      "4840.686661548061`", ",", "4811.484193263918`", ",", 
      "4840.151699513664`", ",", "4854.728186550375`", ",", 
      "4852.799378611466`", ",", "4764.650357828661`", ",", 
      "4792.724040675167`", ",", "4800.640785850515`", ",", 
      "4803.9203104019225`", ",", "4866.372485731573`", ",", 
      "4866.366772922752`", ",", "4892.3165905079595`", ",", 
      "4903.699063477393`", ",", "4895.031904975572`", ",", 
      "4891.725001839585`", ",", "4892.366131166427`", ",", 
      "4881.341103654627`", ",", "4891.891125013465`", ",", 
      "4901.49009984278`", ",", "4884.382182642194`", ",", 
      "4959.198727122373`", ",", "4991.470447653757`", ",", 
      "4972.979411162681`", ",", "4979.071612111139`", ",", 
      "4983.2278456562835`", ",", "4951.352082891739`", ",", 
      "5008.739958505252`", ",", "4971.307092428995`", ",", 
      "5022.953943273583`", ",", "4933.536216382938`"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "5011.1338263086645`", ",", "4972.903268090498`", ",", 
      "5005.281217821387`", ",", "4996.558293010964`", ",", 
      "5019.52157065885`", ",", "5042.212257557519`", ",", 
      "5033.826080600121`", ",", "5016.6159909808675`", ",", 
      "5000.849461439826`", ",", "4965.2262156859215`", ",", 
      "4986.3857248915865`", ",", "4979.244175818412`", ",", 
      "5005.610837513385`", ",", "4941.249180409337`", ",", 
      "4925.081976296192`", ",", "4925.487640334352`", ",", 
      "4935.856871309978`", ",", "4939.589650953569`", ",", 
      "4912.521512287681`", ",", "4924.423644922158`", ",", 
      "4922.984620805359`", ",", "4922.720583880401`", ",", 
      "4919.336460810857`", ",", "4899.683407636883`", ",", 
      "4892.220549571928`", ",", "4911.9207409845785`", ",", 
      "4894.308200092932`", ",", "4938.900900887483`", ",", 
      "4944.634622692969`", ",", "4975.1392656795015`", ",", 
      "4981.783580182955`", ",", "4971.267187789926`", ",", 
      "4943.501027563947`", ",", "4957.5147428889395`", ",", 
      "4943.095201453077`", ",", "4889.959991137765`", ",", 
      "4822.989031204528`", ",", "4852.6368056360725`", ",", 
      "4817.312017849849`", ",", "4815.796094337767`", ",", 
      "4845.444777253037`", ",", "4861.642011712824`", ",", 
      "4841.185094775443`", ",", "4783.135669337711`", ",", 
      "4784.183172013603`", ",", "4796.381687677838`", ",", 
      "4796.75503868054`", ",", "4858.751101287703`", ",", 
      "4879.98379448418`", ",", "4900.48055489466`", ",", 
      "4916.857142692298`", ",", "4909.651483633756`", ",", 
      "4891.688277083843`", ",", "4874.2136381736145`", ",", 
      "4892.316957656712`", ",", "4885.239608043622`", ",", 
      "4883.580400953569`", ",", "4897.938985444322`", ",", 
      "4952.605544757524`", ",", "4963.918974182631`", ",", 
      "4973.663168477752`", ",", "4992.243979025206`", ",", 
      "4984.467264293508`", ",", "4973.097256643094`", ",", 
      "4997.588503732098`", ",", "4985.250024149877`", ",", 
      "4987.327690241551`", ",", "4962.384258988718`"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "5006.7998`", ",", "4968.5`", ",", "5000.5`", ",", "4992.7998`", ",", 
      "5014.7998`", ",", "5036.2998`", ",", "5027.2002`", ",", "5010.8999`", 
      ",", "4996.1001`", ",", "4962.1001`", ",", "4982.1001`", ",", "4975.`", 
      ",", "5000.2002`", ",", "4937.6001`", ",", "4922.1001`", ",", 
      "4923.2998`", ",", "4933.5`", ",", "4937.2998`", ",", "4910.3999`", ",",
       "4922.5`", ",", "4922.5`", ",", "4922.5`", ",", "4919.`", ",", 
      "4900.7002`", ",", "4894.3999`", ",", "4914.`", ",", "4896.7002`", ",", 
      "4942.8999`", ",", "4947.3999`", ",", "4977.`", ",", "4983.7002`", ",", 
      "4973.2998`", ",", "4946.2002`", ",", "4960.7998`", ",", "4945.3999`", 
      ",", "4891.6001`", ",", "4827.1001`", ",", "4855.6001`", ",", "4822.`", 
      ",", "4819.6001`", ",", "4849.2998`", ",", "4864.8999`", ",", "4845.5`",
       ",", "4789.3999`", ",", "4790.2002`", ",", "4801.7002`", ",", 
      "4801.7002`", ",", "4861.2998`", ",", "4882.5`", ",", "4902.2998`", ",",
       "4918.8999`", ",", "4910.2998`", ",", "4892.3999`", ",", "4875.3999`", 
      ",", "4893.2998`", ",", "4886.5`", ",", "4884.2002`", ",", "4898.5`", 
      ",", "4949.3999`", ",", "4962.7002`", ",", "4971.7998`", ",", 
      "4989.7998`", ",", "4982.5`", ",", "4971.5`", ",", "4994.8999`", ",", 
      "4986.2998`", ",", "4986.2998`", ",", "4964.`"}], "}"}]}], "}"}], 
  "\[LeftDoubleBracket]", 
  RowBox[{"{", 
   RowBox[{"5", ",", 
    RowBox[{
     RowBox[{"{", "}"}], "\[LeftDoubleBracket]", 
     RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], "}"}], 
  "\[RightDoubleBracket]"}]], "Output",
 CellChangeTimes->{{3.639485577721883*^9, 3.6394856132191963`*^9}}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  StyleBox["Classifiers", "Title"], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sampleSize", " ", "=", " ", "30"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"windowSize", " ", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"methods", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
    "\"\<NaiveBayes\>\"", ",", " ", "\"\<LogisticRegression\>\"", ",", " ", 
     "\"\<NearestNeighbors\>\"", ",", " ", "\"\<NeuralNetwork\>\"", ",", " ", 
     "\"\<SupportVectorMachine\>\"", ",", "\"\<RandomForest\>\""}], "}"}]}], 
  "\[NoBreak]", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"methods", " ", "=", " ", 
   RowBox[{"{", "\"\<NeuralNetwork\>\"", "}"}]}], "\[NoBreak]", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"priceChanges", " ", "=", " ", "allRealPrices"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"predictedPrices", " ", "=", " ", 
  RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"patterns", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"priceChanges", "[", 
          RowBox[{"[", 
           RowBox[{"j", ";;", 
            RowBox[{"j", "+", "windowSize", "-", "1"}]}], "]"}], "]"}], 
         "\[Rule]", 
         RowBox[{"Sign", "[", 
          RowBox[{
           RowBox[{"priceChanges", "[", 
            RowBox[{"[", 
             RowBox[{"j", "+", "windowSize"}], "]"}], "]"}], "-", 
           RowBox[{"priceChanges", "[", 
            RowBox[{"[", 
             RowBox[{"j", "+", "windowSize", "-", "1"}], "]"}], "]"}]}], 
          "]"}]}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"j", ",", " ", 
          RowBox[{"i", "-", "sampleSize", "+", "1"}], ",", 
          RowBox[{"i", "-", "windowSize"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"trainingPatterns", " ", "=", " ", 
      RowBox[{"patterns", "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", 
         RowBox[{"-", "2"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"testPatterns", " ", "=", " ", 
      RowBox[{"patterns", "[", 
       RowBox[{"[", 
        RowBox[{"-", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"predictors", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Classify", "[", 
         RowBox[{"trainingPatterns", ",", " ", 
          RowBox[{"Method", " ", "\[Rule]", "#"}], ",", " ", 
          RowBox[{"PerformanceGoal", "\[Rule]", "\"\<TrainingSpeed\>\""}]}], 
         "]"}], "&"}], "/@", "  ", "methods"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"If", " ", "[", 
        RowBox[{
         RowBox[{"i", " ", "\[Equal]", " ", "sampleSize"}], ",", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{"ClassifierInformation", "[", "#", "]"}], "]"}], " ", 
           "&"}], " ", "/@", " ", "predictors"}]}], "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"Keys", "[", "testPatterns", "]"}], "]"}], " ", "&"}], " ", "/@",
       "  ", "predictors"}]}], "\[IndentingNewLine]", ",", " ", 
    RowBox[{"{", 
     RowBox[{"i", ",", "sampleSize", ",", 
      RowBox[{"Length", "[", "priceChanges", "]"}]}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"realPrices", " ", "=", " ", 
   RowBox[{"allRealPrices", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Length", "[", "predictedPrices", "]"}]}], ";;", 
      RowBox[{"-", "1"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"beforeRealPrices", " ", "=", " ", 
   RowBox[{"allRealPrices", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Length", "[", "predictedPrices", "]"}]}], "-", "1"}], ";;", 
      RowBox[{"-", "2"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"predictedPricesAllMethods", " ", "=", " ", "predictedPrices"}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"AppendTo", "[", 
  RowBox[{"methods", ",", "\"\<Naive\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"predictedPricesAllMethods", " ", "=", " ", 
   RowBox[{
    RowBox[{"Append", "[", 
     RowBox[{
      RowBox[{"predictedPricesAllMethods", "\[Transpose]"}], ",", 
      "beforeRealPrices"}], "]"}], "\[Transpose]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{
  3.6393283154469957`*^9, {3.639328509166555*^9, 3.6393285932602377`*^9}, {
   3.639328978312738*^9, 3.639328978642516*^9}, {3.639329050115533*^9, 
   3.639329050274129*^9}, {3.639329307507063*^9, 3.639329307905937*^9}, {
   3.639329484978016*^9, 3.6393294851394157`*^9}, {3.639329679518248*^9, 
   3.639329680403595*^9}, {3.639330788768412*^9, 3.639330790031825*^9}, {
   3.6393310207632313`*^9, 3.639331027819089*^9}, {3.6393311531620483`*^9, 
   3.639331169076087*^9}, {3.6393313420994787`*^9, 3.639331344226624*^9}, {
   3.639331381298555*^9, 3.6393313822579823`*^9}, {3.6393314450215063`*^9, 
   3.639331447140607*^9}, {3.639331502198296*^9, 3.6393315038043203`*^9}, {
   3.639384360616971*^9, 3.639384360696185*^9}, {3.63938453979674*^9, 
   3.639384542186225*^9}, 3.639384774748145*^9, {3.639384888686368*^9, 
   3.6393849061126423`*^9}, {3.639385033213779*^9, 3.639385043519874*^9}, {
   3.639385358556423*^9, 3.6393853799269867`*^9}, {3.639386238480872*^9, 
   3.639386238560582*^9}, {3.639386299491623*^9, 3.639386322181839*^9}, {
   3.639386370592433*^9, 3.63938637091987*^9}, {3.6393865205729303`*^9, 
   3.639386528991028*^9}, {3.639386690798424*^9, 3.6393867132546673`*^9}, {
   3.6393868649760323`*^9, 3.6393868854809313`*^9}, 3.639387266349161*^9, {
   3.6394829967820807`*^9, 3.639483013825873*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  StyleBox[
   RowBox[{"Classifiers", " ", "results"}], "Title"], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"measures", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", " ", 
    RowBox[{"i", " ", "\[LessEqual]", 
     RowBox[{"Length", "[", "methods", "]"}]}], ",", " ", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"predictedPrices", " ", "=", " ", 
      RowBox[{"predictedPricesAllMethods", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "i"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"movementAccuracy", " ", "=", " ", 
      RowBox[{
       RowBox[{"Total", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"predictedPrices", " ", "*", " ", 
            RowBox[{"Sign", "[", 
             RowBox[{"realPrices", "-", "beforeRealPrices"}], "]"}]}], "+", 
           "1"}], ")"}], "/", "2"}], "]"}], " ", "/", " ", 
       RowBox[{"Length", "[", "realPrices", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"money", " ", "=", " ", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", " ", "[", 
      RowBox[{
       RowBox[{"t", " ", "=", " ", "2"}], ",", " ", 
       RowBox[{"t", " ", "\[LessEqual]", 
        RowBox[{"Length", "[", "predictedPrices", "]"}]}], ",", " ", 
       RowBox[{"t", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"If", " ", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"predictedPrices", "[", 
           RowBox[{"[", "t", "]"}], "]"}], " ", ">", " ", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"money", " ", "*=", " ", 
           RowBox[{
            RowBox[{"realPrices", "[", 
             RowBox[{"[", "t", "]"}], "]"}], " ", "/", " ", 
            RowBox[{"realPrices", "[", 
             RowBox[{"[", 
              RowBox[{"t", "-", "1"}], "]"}], "]"}]}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"measures", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"N", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"money", "-", "1"}], ")"}], ",", "3"}], "]"}], "*", 
          "100"}], ",", " ", 
         RowBox[{
          RowBox[{"N", "[", 
           RowBox[{"movementAccuracy", ",", "3"}], "]"}], "*", "100"}]}], 
        "}"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"table", " ", "=", " ", 
   RowBox[{"TableForm", "[", 
    RowBox[{"measures", ",", 
     RowBox[{"TableHeadings", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"methods", ",", " ", 
        RowBox[{"{", 
         RowBox[{
         "\"\<Investment profit\>\"", ",", " ", "\"\<Movement accuracy\>\""}],
          "}"}]}], "}"}]}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", "ListPlot", "\
\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.6393283317803383`*^9, 3.639328494592023*^9}, {
  3.63932866077357*^9, 3.6393287306590223`*^9}, {3.639328772752907*^9, 
  3.639328793122508*^9}, {3.639328837965007*^9, 3.6393288858635807`*^9}, {
  3.6393316141779413`*^9, 3.639331615416635*^9}, {3.6393852657194357`*^9, 
  3.63938526898868*^9}, {3.639483005486676*^9, 3.639483006520071*^9}}],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      StyleBox["\[Null]",
       ShowStringCharacters->False], 
      TagBox["\<\"Investment profit\"\>",
       HoldForm], 
      TagBox["\<\"Movement accuracy\"\>",
       HoldForm]},
     {
      TagBox["\<\"NeuralNetwork\"\>",
       HoldForm], 
      RowBox[{"-", "2.031118390278419`"}], 
      "44.87179487179487179487179487179487179491`3."},
     {
      TagBox["\<\"Naive\"\>",
       HoldForm], 
      RowBox[{"-", "0.610888992458658`"}], 
      RowBox[{"-", "7064.935128205128`"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxDividers->{
     "Columns" -> {False, True, {False}, False}, "ColumnsIndexed" -> {}, 
      "Rows" -> {False, True, {False}, False}, "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[2.0999999999999996`]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}],
   {OutputFormsDump`HeadedRows, OutputFormsDump`HeadedColumns}],
  Function[BoxForm`e$, 
   TableForm[
   BoxForm`e$, 
    TableHeadings -> {{"NeuralNetwork", "Naive"}, {
      "Investment profit", "Movement accuracy"}}]]]], "Output",
 CellChangeTimes->{
  3.639328965716292*^9, 3.63932903975667*^9, 3.6393291254027147`*^9, 
   3.639329261782962*^9, 3.639329466352448*^9, 3.639329603177359*^9, 
   3.639331064177038*^9, {3.639331396080666*^9, 3.639331410410096*^9}, {
   3.639331440462308*^9, 3.639331454685176*^9}, 3.639331617399762*^9, {
   3.639384563472378*^9, 3.639384570809306*^9}, 3.6393849213591833`*^9, 
   3.639384990498595*^9, 3.639385245593626*^9, {3.63938531767876*^9, 
   3.639385327573106*^9}, {3.639386289970709*^9, 3.6393863183409863`*^9}, 
   3.639386350062302*^9, 3.639386517515521*^9, 3.63938655048822*^9}],

Cell[BoxData["ListPlot"], "Output",
 CellChangeTimes->{
  3.639328965716292*^9, 3.63932903975667*^9, 3.6393291254027147`*^9, 
   3.639329261782962*^9, 3.639329466352448*^9, 3.639329603177359*^9, 
   3.639331064177038*^9, {3.639331396080666*^9, 3.639331410410096*^9}, {
   3.639331440462308*^9, 3.639331454685176*^9}, 3.639331617399762*^9, {
   3.639384563472378*^9, 3.639384570809306*^9}, 3.6393849213591833`*^9, 
   3.639384990498595*^9, 3.639385245593626*^9, {3.63938531767876*^9, 
   3.639385327573106*^9}, {3.639386289970709*^9, 3.6393863183409863`*^9}, 
   3.639386350062302*^9, 3.639386517515521*^9, 3.6393865504965677`*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.639328959568104*^9, 3.639328959574736*^9}}]
},
WindowSize->{Full, Full},
WindowMargins->{{Automatic, 15}, {82, Automatic}},
FrontEndVersion->"10.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (September 9, \
2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 6864, 117, 190, "Input"],
Cell[7447, 141, 2240, 31, 28, "Output"],
Cell[9690, 174, 2214, 30, 28, "Output"],
Cell[11907, 206, 10317, 199, 244, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22261, 410, 9112, 186, 427, "Input"],
Cell[31376, 598, 227, 3, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[31640, 606, 12439, 274, 988, "Input"],
Cell[44082, 882, 227, 4, 28, "Output"],
Cell[44312, 888, 2417, 61, 126, "Output"],
Cell[46732, 951, 209, 3, 28, "Output"],
Cell[46944, 956, 2196, 43, 330, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[49177, 1004, 609, 16, 63, "Input"],
Cell[49789, 1022, 465, 10, 24, "Message"],
Cell[50257, 1034, 543, 11, 24, "Message"],
Cell[50803, 1047, 10211, 175, 267, "Output"]
}, Open  ]],
Cell[61029, 1225, 5869, 137, 411, "Input"],
Cell[CellGroupData[{
Cell[66923, 1366, 3515, 87, 377, "Input"],
Cell[70441, 1455, 1953, 48, 65, "Output"],
Cell[72397, 1505, 630, 9, 28, "Output"]
}, Open  ]],
Cell[73042, 1517, 92, 1, 28, "Input"]
}
]
*)

(* End of internal cache information *)
