(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     66849,       1414]
NotebookOptionsPosition[     65868,       1378]
NotebookOutlinePosition[     66227,       1394]
CellTagsIndexPosition[     66184,       1391]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  StyleBox[
   RowBox[{"Stock", " ", "Data"}], "Title"], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"stockData", " ", "=", "  ", 
   RowBox[{"FinancialData", "[", 
    RowBox[{"\"\<^FTSE\>\"", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"DateObject", "[", 
        RowBox[{"{", 
         RowBox[{"2005", ",", "1", ",", "1"}], "}"}], "]"}], ",", 
       RowBox[{"DateObject", "[", 
        RowBox[{"{", 
         RowBox[{"2006", ",", "6", ",", "1"}], "}"}], "]"}]}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"stockPrices", " ", "=", 
   RowBox[{"stockData", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", " ", "2"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"allRealPrices", " ", "=", " ", 
   RowBox[{"stockPrices", "[", 
    RowBox[{"[", 
     RowBox[{"2", ";;", 
      RowBox[{"-", "1"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"allBeforeRealPrices", " ", "=", " ", 
   RowBox[{"stockPrices", "[", 
    RowBox[{"[", 
     RowBox[{"1", ";;", 
      RowBox[{"-", "2"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"priceChanges", " ", "=", " ", 
   RowBox[{"allRealPrices", " ", "/", " ", "allBeforeRealPrices"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Length", "[", "stockPrices", "]"}], "\[IndentingNewLine]", 
 RowBox[{"plot", " ", "=", " ", 
  RowBox[{"ListLinePlot", "[", 
   RowBox[{
    RowBox[{"{", "stockPrices", "}"}], ",", 
    RowBox[{"PlotLegends", "\[Rule]", 
     RowBox[{"{", "\"\<HSI\>\"", "}"}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.6327429749183187`*^9, 3.632743020241493*^9}, {
   3.6327430626191893`*^9, 3.632743090887294*^9}, {3.6327431696368628`*^9, 
   3.632743265307125*^9}, {3.632818908440407*^9, 3.632818918693774*^9}, {
   3.632819209839077*^9, 3.632819277820066*^9}, {3.632824267972762*^9, 
   3.632824342950367*^9}, 3.6328244537699013`*^9, {3.632824489662837*^9, 
   3.632824492534006*^9}, {3.632826927606759*^9, 3.632827019607327*^9}, {
   3.632827051698964*^9, 3.632827075833501*^9}, {3.6328283338475122`*^9, 
   3.6328283756134577`*^9}, {3.632828490184004*^9, 3.6328286814064407`*^9}, {
   3.632828713009672*^9, 3.6328289183841753`*^9}, 3.6328289841993227`*^9, 
   3.632829784376502*^9, {3.632829846230926*^9, 3.6328299638828087`*^9}, 
   3.632830301095127*^9, {3.632830702617859*^9, 3.63283070324082*^9}, {
   3.632830800887021*^9, 3.632830803951688*^9}, {3.632830837346504*^9, 
   3.6328308456632967`*^9}, {3.632832892496992*^9, 3.632832901906269*^9}, {
   3.632833024787912*^9, 3.632833026149979*^9}, {3.632891562899342*^9, 
   3.6328915983158092`*^9}, {3.6328916456009893`*^9, 3.632891648448402*^9}, {
   3.6328933614187*^9, 3.632893365882728*^9}, {3.632893431404941*^9, 
   3.63289344618089*^9}, {3.6328940573041353`*^9, 3.6328940790629587`*^9}, {
   3.632894741618835*^9, 3.6328947444438467`*^9}, {3.632896710633057*^9, 
   3.632896710820706*^9}, {3.632896742567802*^9, 3.63289674313235*^9}, {
   3.6328973402368803`*^9, 3.632897348356823*^9}, {3.632899649473171*^9, 
   3.632899649557293*^9}, {3.632900485425768*^9, 3.6329004950102177`*^9}, {
   3.632901775916894*^9, 3.632901776181129*^9}, {3.632903877523225*^9, 
   3.632903959212545*^9}, {3.632903990981168*^9, 3.632904025699132*^9}, {
   3.632906452461577*^9, 3.632906470227483*^9}, {3.632906520119938*^9, 
   3.632906521045575*^9}, {3.632907193195321*^9, 3.6329072136441317`*^9}, {
   3.6329905250634127`*^9, 3.632990591188364*^9}, {3.632991561295353*^9, 
   3.632991570103318*^9}, {3.632991636057946*^9, 3.632991659106139*^9}, {
   3.6329920227291727`*^9, 3.63299203946486*^9}, {3.6329921663668833`*^9, 
   3.632992166575158*^9}, {3.632992524673924*^9, 3.632992525744252*^9}, {
   3.6329925601540537`*^9, 3.632992560272737*^9}, {3.63299272898595*^9, 
   3.632992729041778*^9}, {3.6329957872645693`*^9, 3.632995787818033*^9}, {
   3.632996556565926*^9, 3.632996594273795*^9}, {3.6393017045235023`*^9, 
   3.639301704761613*^9}, {3.639301738948237*^9, 3.639301742862405*^9}, {
   3.6393017848600063`*^9, 3.639301803864708*^9}, {3.6393018471736603`*^9, 
   3.6393019869752283`*^9}, {3.639302373634831*^9, 3.63930241856748*^9}, {
   3.639302480138391*^9, 3.639302534361251*^9}, {3.6393027015415382`*^9, 
   3.639302718461164*^9}, {3.639302785082328*^9, 3.639303018303033*^9}, {
   3.639305437149797*^9, 3.639305449865726*^9}, {3.639305518802198*^9, 
   3.639305519014502*^9}, {3.639305933947773*^9, 3.639305934300606*^9}, {
   3.639305995353513*^9, 3.639306022569894*^9}, 3.6393061553258953`*^9, {
   3.639306290465506*^9, 3.639306290779763*^9}, {3.6393063497904987`*^9, 
   3.639306350747435*^9}, {3.6393072377839727`*^9, 3.639307238643078*^9}, {
   3.639307458391555*^9, 3.639307466495369*^9}, {3.639307509675352*^9, 
   3.639307509911058*^9}, {3.6393078158593473`*^9, 3.639307867055065*^9}, {
   3.639308541527812*^9, 3.639308541764086*^9}, {3.639308589974814*^9, 
   3.639308624692738*^9}, {3.639308709699504*^9, 3.63930870988833*^9}, {
   3.6393087775414867`*^9, 3.6393087808398457`*^9}, {3.639309018679047*^9, 
   3.639309023283306*^9}, {3.6393126682746897`*^9, 3.639312682773988*^9}, {
   3.639313093902979*^9, 3.639313123887788*^9}, {3.639313274785696*^9, 
   3.639313315802662*^9}, {3.639313414609424*^9, 3.639313420840898*^9}, {
   3.639314127635388*^9, 3.639314127920916*^9}, {3.6393145055780077`*^9, 
   3.639314610381082*^9}, {3.6393147168776197`*^9, 3.6393148198980207`*^9}, {
   3.639314859269022*^9, 3.639314859803797*^9}, {3.639314894737595*^9, 
   3.639314909336363*^9}, {3.639314953654141*^9, 3.639314956665535*^9}, {
   3.639315354084749*^9, 3.639315354629163*^9}, {3.639315407423287*^9, 
   3.63931540794461*^9}, {3.6393265300277033`*^9, 3.639326533756289*^9}, {
   3.639327591228373*^9, 3.639327612125977*^9}, {3.6393289832237*^9, 
   3.639328984894271*^9}, {3.6393291692191896`*^9, 3.6393291731816273`*^9}, {
   3.639330745722433*^9, 3.6393307512365913`*^9}, {3.6393314260701113`*^9, 
   3.639331426218782*^9}, {3.639333165317617*^9, 3.6393331790991287`*^9}, {
   3.6393841585739393`*^9, 3.639384158670869*^9}, {3.639384191285946*^9, 
   3.639384212235729*^9}, {3.639384253503276*^9, 3.639384272855797*^9}, {
   3.639384312477126*^9, 3.6393843510229177`*^9}, {3.639384933549797*^9, 
   3.639384933607205*^9}, {3.639385049139201*^9, 3.63938506048569*^9}, {
   3.6393852832213287`*^9, 3.639385294090139*^9}, {3.639385345207466*^9, 
   3.639385345299693*^9}, {3.639387573866659*^9, 3.639387574598542*^9}, {
   3.6393876445085583`*^9, 3.639387644927718*^9}, {3.6394211316036463`*^9, 
   3.639421135230335*^9}, {3.639422934845027*^9, 3.639422935280756*^9}, 
   3.639481687346161*^9, 3.6394817771843243`*^9, {3.639482958988761*^9, 
   3.6394829648764257`*^9}, {3.639483473396893*^9, 3.639483492309408*^9}, {
   3.639483549599128*^9, 3.63948355677179*^9}, {3.639486798248583*^9, 
   3.639486798643305*^9}, {3.63948684974056*^9, 3.63948685447735*^9}, {
   3.639487003257835*^9, 3.639487005149695*^9}}],

Cell[BoxData[
 RowBox[{"Data", " ", "Stock"}]], "Output",
 CellChangeTimes->{{3.639301859665298*^9, 3.6393018644901037`*^9}, {
   3.639301974190961*^9, 3.639301996256754*^9}, {3.6393023760163403`*^9, 
   3.639302420215407*^9}, 3.639302483755946*^9, {3.6393025260405693`*^9, 
   3.639302535327207*^9}, {3.639302796962029*^9, 3.6393028502431602`*^9}, {
   3.639302883715176*^9, 3.6393029207465963`*^9}, {3.6393029962237167`*^9, 
   3.6393030064674883`*^9}, 3.639305450498335*^9, 3.639305523881008*^9, 
   3.639306172522728*^9, 3.639306401186561*^9, 3.639307336064309*^9, 
   3.639307377710259*^9, 3.6393074683025827`*^9, 3.6393075695251513`*^9, {
   3.6393078235792627`*^9, 3.639307868045302*^9}, 3.6393085433113413`*^9, 
   3.639308626388081*^9, 3.639308715309992*^9, 3.639308783536446*^9, {
   3.639312677114149*^9, 3.639312683363263*^9}, {3.639313095786344*^9, 
   3.6393131269114723`*^9}, 3.639313168699972*^9, 3.639313283766283*^9, 
   3.6393133169335833`*^9, {3.639313421556841*^9, 3.639313441355784*^9}, 
   3.639314130291254*^9, 3.639314162882523*^9, 3.639314196674416*^9, {
   3.639314508542508*^9, 3.63931461164961*^9}, {3.639314738314741*^9, 
   3.639314820501873*^9}, 3.63931486032609*^9, {3.639314895458346*^9, 
   3.6393149212846527`*^9}, 3.639315408821526*^9, 3.6393265358066196`*^9, {
   3.639327596082115*^9, 3.639327612621426*^9}, 3.639328985670515*^9, 
   3.639329173929081*^9, 3.6393294876239243`*^9, {3.63933074745725*^9, 
   3.63933075162836*^9}, 3.639330987250695*^9, 3.639331426853785*^9, {
   3.63933317591182*^9, 3.6393331795865993`*^9}, {3.639384152511649*^9, 
   3.6393841592874403`*^9}, {3.6393841927260323`*^9, 3.639384206807643*^9}, {
   3.639384257319615*^9, 3.639384283778561*^9}, {3.639384330876401*^9, 
   3.6393843513619223`*^9}, {3.639384461580447*^9, 3.639384469401099*^9}, 
   3.639384601823175*^9, 3.639384684731182*^9, 3.6393849348798733`*^9, {
   3.639385052852964*^9, 3.63938506150224*^9}, 3.639385296622424*^9, 
   3.639385345834155*^9, 3.639387419106512*^9, 3.6393875212821417`*^9, 
   3.639387575327758*^9, 3.639387645529807*^9, 3.639414968465369*^9, 
   3.6394210874994287`*^9, 3.639421135863529*^9, 3.6394229361257133`*^9, 
   3.639483473952318*^9, {3.639483550260244*^9, 3.63948355706079*^9}, 
   3.6394867990554857`*^9, {3.6394868503437233`*^9, 3.6394868548152657`*^9}, 
   3.639487005880721*^9}],

Cell[BoxData["369"], "Output",
 CellChangeTimes->{{3.639301859665298*^9, 3.6393018644901037`*^9}, {
   3.639301974190961*^9, 3.639301996256754*^9}, {3.6393023760163403`*^9, 
   3.639302420215407*^9}, 3.639302483755946*^9, {3.6393025260405693`*^9, 
   3.639302535327207*^9}, {3.639302796962029*^9, 3.6393028502431602`*^9}, {
   3.639302883715176*^9, 3.6393029207465963`*^9}, {3.6393029962237167`*^9, 
   3.6393030064674883`*^9}, 3.639305450498335*^9, 3.639305523881008*^9, 
   3.639306172522728*^9, 3.639306401186561*^9, 3.639307336064309*^9, 
   3.639307377710259*^9, 3.6393074683025827`*^9, 3.6393075695251513`*^9, {
   3.6393078235792627`*^9, 3.639307868045302*^9}, 3.6393085433113413`*^9, 
   3.639308626388081*^9, 3.639308715309992*^9, 3.639308783536446*^9, {
   3.639312677114149*^9, 3.639312683363263*^9}, {3.639313095786344*^9, 
   3.6393131269114723`*^9}, 3.639313168699972*^9, 3.639313283766283*^9, 
   3.6393133169335833`*^9, {3.639313421556841*^9, 3.639313441355784*^9}, 
   3.639314130291254*^9, 3.639314162882523*^9, 3.639314196674416*^9, {
   3.639314508542508*^9, 3.63931461164961*^9}, {3.639314738314741*^9, 
   3.639314820501873*^9}, 3.63931486032609*^9, {3.639314895458346*^9, 
   3.6393149212846527`*^9}, 3.639315408821526*^9, 3.6393265358066196`*^9, {
   3.639327596082115*^9, 3.639327612621426*^9}, 3.639328985670515*^9, 
   3.639329173929081*^9, 3.6393294876239243`*^9, {3.63933074745725*^9, 
   3.63933075162836*^9}, 3.639330987250695*^9, 3.639331426853785*^9, {
   3.63933317591182*^9, 3.6393331795865993`*^9}, {3.639384152511649*^9, 
   3.6393841592874403`*^9}, {3.6393841927260323`*^9, 3.639384206807643*^9}, {
   3.639384257319615*^9, 3.639384283778561*^9}, {3.639384330876401*^9, 
   3.6393843513619223`*^9}, {3.639384461580447*^9, 3.639384469401099*^9}, 
   3.639384601823175*^9, 3.639384684731182*^9, 3.6393849348798733`*^9, {
   3.639385052852964*^9, 3.63938506150224*^9}, 3.639385296622424*^9, 
   3.639385345834155*^9, 3.639387419106512*^9, 3.6393875212821417`*^9, 
   3.639387575327758*^9, 3.639387645529807*^9, 3.639414968465369*^9, 
   3.6394210874994287`*^9, 3.639421135863529*^9, 3.6394229361257133`*^9, 
   3.639483473952318*^9, {3.639483550260244*^9, 3.63948355706079*^9}, 
   3.6394867990554857`*^9, {3.6394868503437233`*^9, 3.6394868548152657`*^9}, 
   3.639487006200358*^9}],

Cell[BoxData[
 TemplateBox[{GraphicsBox[{{}, {{{}, {}, {
        Hue[0.67, 0.6, 0.6], 
        Directive[
         PointSize[0.011111111111111112`], 
         RGBColor[0.368417, 0.506779, 0.709798], 
         AbsoluteThickness[1.6]], 
        LineBox[CompressedData["
1:eJxdmGlsVGUYhS/GuMQ/jRJiI+poFFER0CqoKFxFQHSAthTK1jLdpi3dO10i
Eb1RIsYdUWNF44DGuGCsDmBiYhxASdRGUXHfxiXVxKiVzWjcYs95mnT48+Xh
fc973vPde1vCGdVtpXVHBUHQMSYI/j/1Z2hW+coXX4u/81Lov9D5K3yczr1w
QTjc/wk8NiwrPSddeAQ+OXzmyYVh5kd4vPh9ODbc3/cCfKbmZeGzhnlgPzxB
+l/gieG25z9ZPfgxfJ70I/MnST8yb7Lqe+Cpw2c0AF84PL/oJ/gi5RnJXzTs
lzwMX6z5OfgSzT8ET9O88zLm6eKL4UvVPwm+TPssgC/X/BQ8Q/Vb4Su0z03w
lTpvh2fKbzs8S/NehEPd325zFKr/VepXaf4u6lepDgdXa97r1K/WvKepz9a+
N1Kfrftspn6N9PdQv0b9DdTniMkTzVF/RH2u+CHq4vg26vO07xPU52m/+6lf
q33WUzdXU58v7qE+X2cb9es0f2S/6/Q+z6d+vfSXU79e+82gHle+OdTjqo/o
F+j+J1NfoH7mBQtHc5THwSKd06kv0vdzFvVizT/NHBbrvIj+YvXHzFn1Dy5E
XyL9YvQlOjvQl0jfi75E+VrQl+r+StGX6nkm0Jdqfgn6Ut3vKegX634/9/cW
ivt+N0eLdX5kzrr+Ad9nmfb5DX2Z8gX4l+k+f0avenIH+iXafyd6cWYX/nmc
XSK/v9Ev1fwTyb9U9Qn4L9U+08jvOu9DUK59xqM3n4C+XP2noi+X3zj0y7T/
WPTLVD8T/TLNW4Je/ZmR72O5nlcTevM69Ms1j+8na6Y/WKF8t6BfoX3Xos/j
7AqdtehX6tyE3nw3+pXafwN6cxf6VZq/Bf0q5bsTvbhoI/pV0j+FvkL8CvoK
5d+JvkJ5N6MXBzvQV+p9/BB9pc596FUv/Ax9pfb9Cf1q+f+JfrXOj9GLowx6
93+LPqH5h82xhPL+wbyEznO360wk5B+aI+vnmtPivhZz1v0TzDnPbzcHVdpn
rTlWpXqVOVR9cB3+VX4++Lveir/1lfhXaZ8S/F1fjX+16nX4V+v53YB/tfwe
wr/aP+/xt/5e/KWP0581b8W/Wvs+i3+Nns+7+Neofz/+ru/BX/WB3fi7P4d/
jfY9iL/1Y3bYv0b7/oJ/reZ9g3+t8jEvrNXzeQt/1TPb8Jc+/iD+tZqfxd/6
veT3/O3414k34y/ObMC/zv9ewD+PozrtT3+6Tvfbj3+d8u/D3/V38E9K/yn+
Se3zK/5J9R/G3/1f4C+O059Oar9/8U/q/Ax/zUt+h3+99jvWzydWL7/TzWG9
7uMSc0L15ERz5Pof+JuPdz1br+dxNs9fXLjAHDRo/3n4iwd68G/QfSTxF2fq
8G/Q/HXmdIP2Q5/1vCL8Xf+L/I3yP8D9N2reP9x/o/yOxl9c9BX3b95I/kad
vE9ZcfQU99+o++V7DdaIp+C/RvczCX/zOJ6/uK8cf9dn4r/Gvw/xN1PPyS9Z
gX+T8r+Bf9Po7zlsGv29Jpq073Tu3/Up3L/0A2Xcv/vhnOuzeP7Nuh/0sWbl
Wc7zVz2o5P5V70MfuT4Nf/OIf7P81+JvvgH/Fj2/u/EXZzbj36JzA/4t2n8T
/i26T97HtPtT+Hs++XItyteKf6v4YfxbNe82/FvltxV/M/2R9eybtp482Vbd
L99HrlX73Ip/m/Qb8W/T8+/FX/U+5idUH3gC/zbd53P4i5Mf4N+m80v8xdHn
+LeP5oI8jrXL74h5qjh+zE7v5/oB14vzOOF5F7q/vV15Ss1Ru+5jhvk+62vM
aevhftcvNWfz6vs8r96cUz1YZB5yvdkcdOicbS7o0Pt3ujkmLrrSPLXDP3/J
Lx4cby7u0H5jzAn3X0v+DuVfQX73P0J+8ybyi+MR+a1/hvyup8hvvpn89r+L
/J7fSf5OvX8V5O9UvZ/8rq8nf6fuewv51R9Pk9/1x8nfqft5nfydus+PyK/+
4Afyq575hvzSJ4fI7/4B8tvve/Lb7yD58/YZcp795E/pfJP8Kfl/S/6U7uP4
l50/pX3YLxQPbie/+Wvym0+yvt3zQnOU0vOcab4v5d/P5rT6443mfvu3mbPe
t968z/1wTvmiXvOQ5yfNQZf6HzAXdOn5lJlj4swU8rs+zxxaf7O5uEt54uaE
67eT3/O6yK/+wkfJ7/pj5Hf9DvJ36cyQXxxF5JffQDv5u/zzmPx5HHSP5oLu
0fvEujXvTfK7fxf5u7XvIfKb3ye/5vXtJX+3/7+U/N06t5Hf/hvIn8f95t3k
t34t+bXfIM8z533eJr/13F/Qo/0+JX+P8u0hf4/OR8iv/sKTyd+jPO/x/veM
/r4T0kfn8/3b7xy+f/sV8v1Ln3mU32fmyXz/9h/5/eb6BXz/3pfvPZfHQ+ax
fP+9er4r+f57Na97Z/gfI66Q+A==
         "]]}}}, {}}, {
    DisplayFunction -> Identity, PlotRangePadding -> {{
        Scaled[0.02], 
        Scaled[0.02]}, {
        Scaled[0.05], 
        Scaled[0.05]}}, AxesOrigin -> {0, 4716.145095}, 
     PlotRange -> {{0., 369.}, {4783.6001, 6132.7002}}, DisplayFunction -> 
     Identity, AspectRatio -> NCache[GoldenRatio^(-1), 0.6180339887498948], 
     Axes -> {True, True}, AxesLabel -> {None, None}, 
     AxesOrigin -> {0, 4716.145095}, DisplayFunction :> Identity, 
     Frame -> {{False, False}, {False, False}}, 
     FrameLabel -> {{None, None}, {None, None}}, 
     FrameTicks -> {{Automatic, Automatic}, {Automatic, Automatic}}, 
     GridLines -> {None, None}, GridLinesStyle -> Directive[
       GrayLevel[0.5, 0.4]], Method -> {}, 
     PlotRange -> {{0., 369.}, {4783.6001, 6132.7002}}, PlotRangeClipping -> 
     True, PlotRangePadding -> {{
        Scaled[0.02], 
        Scaled[0.02]}, {
        Scaled[0.05], 
        Scaled[0.05]}}, Ticks -> {Automatic, Automatic}}],FormBox[
    FormBox[
     TemplateBox[{"\"HSI\""}, "LineLegend", DisplayFunction -> (FormBox[
        StyleBox[
         StyleBox[
          PaneBox[
           TagBox[
            GridBox[{{
               TagBox[
                GridBox[{{
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.2], 
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[1.6]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.2], 
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[1.6]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #}}, 
                 GridBoxAlignment -> {
                  "Columns" -> {Center, Left}, "Rows" -> {{Baseline}}}, 
                 AutoDelete -> False, 
                 GridBoxDividers -> {
                  "Columns" -> {{False}}, "Rows" -> {{False}}}, 
                 GridBoxItemSize -> {"Columns" -> {{All}}, "Rows" -> {{All}}},
                  GridBoxSpacings -> {
                  "Columns" -> {{0.5}}, "Rows" -> {{0.8}}}], "Grid"]}}, 
             GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
             AutoDelete -> False, 
             GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{1}}, "Rows" -> {{0}}}], 
            "Grid"], Alignment -> Left, AppearanceElements -> None, 
           ImageMargins -> {{5, 5}, {5, 5}}, ImageSizeAction -> 
           "ResizeToFit"], LineIndent -> 0, StripOnInput -> False], {
         FontFamily -> "Arial"}, Background -> Automatic, StripOnInput -> 
         False], TraditionalForm]& ), 
      InterpretationFunction :> (RowBox[{"LineLegend", "[", 
         RowBox[{
           RowBox[{"{", 
             RowBox[{"Directive", "[", 
               RowBox[{
                 RowBox[{"PointSize", "[", "0.011111111111111112`", "]"}], 
                 ",", 
                 InterpretationBox[
                  ButtonBox[
                   TooltipBox[
                    RowBox[{
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    RectangleBox[{0, -1}, {2, 1}]}}, AspectRatio -> 1, Frame -> 
                    True, FrameStyle -> 
                    RGBColor[
                    0.24561133333333335`, 0.3378526666666667, 
                    0.4731986666666667], FrameTicks -> None, PlotRangePadding -> 
                    None, ImageSize -> 
                    Dynamic[{
                    Automatic, 1.35 CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification]}]], 
                    "\[InvisibleSpace]"}], 
                    "RGBColor[0.368417, 0.506779, 0.709798]"], Appearance -> 
                   None, BaseStyle -> {}, BaselinePosition -> Baseline, 
                   DefaultBaseStyle -> {}, ButtonFunction :> 
                   With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[0.368417, 0.506779, 0.709798]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                   Automatic, Method -> "Preemptive"], 
                  RGBColor[0.368417, 0.506779, 0.709798], Editable -> False, 
                  Selectable -> False], ",", 
                 RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}], 
             "}"}], ",", 
           RowBox[{"{", #, "}"}], ",", 
           RowBox[{"Joined", "\[Rule]", 
             RowBox[{"{", 
               RowBox[{"{", "True", "}"}], "}"}]}], ",", 
           RowBox[{"LabelStyle", "\[Rule]", 
             RowBox[{"{", "}"}]}], ",", 
           RowBox[{"LegendLayout", "\[Rule]", "\"Column\""}], ",", 
           RowBox[{"LegendMarkers", "\[Rule]", 
             RowBox[{"{", 
               RowBox[{"{", 
                 RowBox[{"False", ",", "Automatic"}], "}"}], "}"}]}]}], 
         "]"}]& ), Editable -> True], TraditionalForm], TraditionalForm]},
  "Legended",
  DisplayFunction->(GridBox[{{
      TagBox[
       ItemBox[
        PaneBox[
         TagBox[#, "SkipImageSizeLevel"], Alignment -> {Center, Baseline}, 
         BaselinePosition -> Baseline], DefaultBaseStyle -> "Labeled"], 
       "SkipImageSizeLevel"], 
      ItemBox[#2, DefaultBaseStyle -> "LabeledLabel"]}}, 
    GridBoxAlignment -> {"Columns" -> {{Center}}, "Rows" -> {{Center}}}, 
    AutoDelete -> False, GridBoxItemSize -> Automatic, 
    BaselinePosition -> {1, 1}]& ),
  Editable->True,
  InterpretationFunction->(RowBox[{"Legended", "[", 
     RowBox[{#, ",", 
       RowBox[{"Placed", "[", 
         RowBox[{#2, ",", "After"}], "]"}]}], "]"}]& )]], "Output",
 CellChangeTimes->{{3.639301859665298*^9, 3.6393018644901037`*^9}, {
   3.639301974190961*^9, 3.639301996256754*^9}, {3.6393023760163403`*^9, 
   3.639302420215407*^9}, 3.639302483755946*^9, {3.6393025260405693`*^9, 
   3.639302535327207*^9}, {3.639302796962029*^9, 3.6393028502431602`*^9}, {
   3.639302883715176*^9, 3.6393029207465963`*^9}, {3.6393029962237167`*^9, 
   3.6393030064674883`*^9}, 3.639305450498335*^9, 3.639305523881008*^9, 
   3.639306172522728*^9, 3.639306401186561*^9, 3.639307336064309*^9, 
   3.639307377710259*^9, 3.6393074683025827`*^9, 3.6393075695251513`*^9, {
   3.6393078235792627`*^9, 3.639307868045302*^9}, 3.6393085433113413`*^9, 
   3.639308626388081*^9, 3.639308715309992*^9, 3.639308783536446*^9, {
   3.639312677114149*^9, 3.639312683363263*^9}, {3.639313095786344*^9, 
   3.6393131269114723`*^9}, 3.639313168699972*^9, 3.639313283766283*^9, 
   3.6393133169335833`*^9, {3.639313421556841*^9, 3.639313441355784*^9}, 
   3.639314130291254*^9, 3.639314162882523*^9, 3.639314196674416*^9, {
   3.639314508542508*^9, 3.63931461164961*^9}, {3.639314738314741*^9, 
   3.639314820501873*^9}, 3.63931486032609*^9, {3.639314895458346*^9, 
   3.6393149212846527`*^9}, 3.639315408821526*^9, 3.6393265358066196`*^9, {
   3.639327596082115*^9, 3.639327612621426*^9}, 3.639328985670515*^9, 
   3.639329173929081*^9, 3.6393294876239243`*^9, {3.63933074745725*^9, 
   3.63933075162836*^9}, 3.639330987250695*^9, 3.639331426853785*^9, {
   3.63933317591182*^9, 3.6393331795865993`*^9}, {3.639384152511649*^9, 
   3.6393841592874403`*^9}, {3.6393841927260323`*^9, 3.639384206807643*^9}, {
   3.639384257319615*^9, 3.639384283778561*^9}, {3.639384330876401*^9, 
   3.6393843513619223`*^9}, {3.639384461580447*^9, 3.639384469401099*^9}, 
   3.639384601823175*^9, 3.639384684731182*^9, 3.6393849348798733`*^9, {
   3.639385052852964*^9, 3.63938506150224*^9}, 3.639385296622424*^9, 
   3.639385345834155*^9, 3.639387419106512*^9, 3.6393875212821417`*^9, 
   3.639387575327758*^9, 3.639387645529807*^9, 3.639414968465369*^9, 
   3.6394210874994287`*^9, 3.639421135863529*^9, 3.6394229361257133`*^9, 
   3.639483473952318*^9, {3.639483550260244*^9, 3.63948355706079*^9}, 
   3.6394867990554857`*^9, {3.6394868503437233`*^9, 3.6394868548152657`*^9}, 
   3.6394870062801247`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  StyleBox["Predictors", "Title"], 
  StyleBox["\[IndentingNewLine]", "Title"]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sampleSize", "=", "300"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"windowSize", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"methods", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
     "\"\<NearestNeighbors\>\"", ",", " ", "\"\<NeuralNetwork\>\"", ",", " ", 
      "\"\<RandomForest\>\"", ",", " ", "\"\<LinearRegression\>\""}], "}"}]}],
    ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"methods", " ", "=", " ", 
     RowBox[{"{", "\"\<NeuralNetwork\>\"", "}"}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"iterations", " ", "=", " ", "sampleSize"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetSharedVariable", "[", "iterations", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"predictedPrices", " ", "=", " ", 
   RowBox[{"Monitor", "[", 
    RowBox[{
     RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"iterations", "++"}], ";", "\[IndentingNewLine]", 
        RowBox[{"patterns", " ", "=", " ", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"priceChanges", "[", 
             RowBox[{"[", 
              RowBox[{"j", ";;", 
               RowBox[{"j", "+", "windowSize", "-", "1"}]}], "]"}], "]"}], 
            "\[Rule]", 
            RowBox[{"priceChanges", "[", 
             RowBox[{"[", 
              RowBox[{"j", "+", "windowSize"}], "]"}], "]"}]}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"j", ",", " ", 
             RowBox[{"i", "-", "sampleSize", "+", "1"}], ",", 
             RowBox[{"i", "-", "windowSize"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"trainingPatterns", " ", "=", " ", 
         RowBox[{"patterns", "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", 
            RowBox[{"-", "2"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"testPatterns", " ", "=", " ", 
         RowBox[{"patterns", "[", 
          RowBox[{"[", 
           RowBox[{"-", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"predictors", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Predict", "[", 
            RowBox[{"trainingPatterns", ",", " ", 
             RowBox[{"Method", " ", "\[Rule]", "#"}], ",", " ", 
             RowBox[{"PerformanceGoal", "\[Rule]", "\"\<Quality\>\""}]}], 
            "]"}], "&"}], "/@", "  ", "methods"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"If", " ", "[", 
           RowBox[{
            RowBox[{"i", " ", "\[Equal]", " ", "sampleSize"}], ",", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{"PredictorInformation", "[", "#", "]"}], "]"}], " ", 
              "&"}], " ", "/@", " ", "predictors"}]}], "]"}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"Keys", "[", "testPatterns", "]"}], "]"}], "  ", "*", " ", 
           RowBox[{"allBeforeRealPrices", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], " ", "&"}], " ", "/@", "  ", 
         "predictors"}]}], "\[IndentingNewLine]", ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", "sampleSize", ",", 
         RowBox[{"Length", "[", "priceChanges", "]"}]}], "}"}]}], "]"}], ",", 
     
     RowBox[{"ProgressIndicator", "[", 
      RowBox[{"iterations", ",", " ", 
       RowBox[{"{", 
        RowBox[{"sampleSize", ",", 
         RowBox[{"Length", "[", "priceChanges", "]"}]}], "}"}]}], "]"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"realPrices", " ", "=", " ", 
   RowBox[{"allRealPrices", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Length", "[", "predictedPrices", "]"}]}], ";;", 
      RowBox[{"-", "1"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"beforeRealPrices", " ", "=", " ", 
   RowBox[{"allRealPrices", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Length", "[", "predictedPrices", "]"}]}], "-", "1"}], ";;", 
      RowBox[{"-", "2"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"predictedPricesAllMethods", " ", "=", " ", "predictedPrices"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"methods", ",", "\"\<Naive\>\""}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"predictedPricesAllMethods", " ", "=", " ", 
   RowBox[{
    RowBox[{"Append", "[", 
     RowBox[{
      RowBox[{"predictedPricesAllMethods", "\[Transpose]"}], ",", 
      "beforeRealPrices"}], "]"}], "\[Transpose]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.639302639351822*^9, 3.639302639788286*^9}, {
   3.639303318904319*^9, 3.63930332790415*^9}, {3.639303394337605*^9, 
   3.639303524914612*^9}, {3.639303606413714*^9, 3.63930364788246*^9}, {
   3.639303681057768*^9, 3.6393036917716923`*^9}, {3.63930374699865*^9, 
   3.6393038233939734`*^9}, {3.639303860187368*^9, 3.63930390114093*^9}, {
   3.639303932842737*^9, 3.639303966551724*^9}, {3.63930407241754*^9, 
   3.639304134905808*^9}, {3.639304165517962*^9, 3.6393042366954517`*^9}, {
   3.639304302944544*^9, 3.639304313679422*^9}, {3.6393043669873247`*^9, 
   3.639304592279016*^9}, {3.639304622639957*^9, 3.6393047015247383`*^9}, {
   3.639304732308839*^9, 3.639305020816394*^9}, {3.639305053001966*^9, 
   3.639305194473999*^9}, 3.6393052787793093`*^9, {3.6393054107653008`*^9, 
   3.639305429265347*^9}, {3.639305482483985*^9, 3.6393054931972647`*^9}, {
   3.6393055464244537`*^9, 3.639305549256287*^9}, {3.639305593098781*^9, 
   3.639305753247736*^9}, {3.639305881385582*^9, 3.639305882592334*^9}, {
   3.639305921337908*^9, 3.63930592693792*^9}, {3.639306027318001*^9, 
   3.639306100380043*^9}, {3.63930615783666*^9, 3.639306278727159*^9}, {
   3.639306316962873*^9, 3.639306355444783*^9}, 3.639307520619192*^9, {
   3.639307624871233*^9, 3.63930762584724*^9}, {3.639307681427466*^9, 
   3.639307691714141*^9}, {3.639307736886166*^9, 3.639307737573299*^9}, {
   3.6393078826724358`*^9, 3.63930788369692*^9}, {3.6393079195748177`*^9, 
   3.639307923870119*^9}, {3.6393079934719543`*^9, 3.639307993568211*^9}, {
   3.639308117263754*^9, 3.639308304987617*^9}, {3.639308450674521*^9, 
   3.6393084515768948`*^9}, {3.639308495707758*^9, 3.639308499394157*^9}, {
   3.639308537726284*^9, 3.639308539027495*^9}, {3.6393086714333773`*^9, 
   3.639308672136149*^9}, 3.6393087272321978`*^9, {3.6393088630273533`*^9, 
   3.6393088873284473`*^9}, {3.639308970484923*^9, 3.639308988893338*^9}, {
   3.639309043886277*^9, 3.639309045165601*^9}, {3.639309075613531*^9, 
   3.639309214510051*^9}, {3.63930927218476*^9, 3.6393095181550093`*^9}, {
   3.639309572443969*^9, 3.639309577754456*^9}, {3.639309617377301*^9, 
   3.639309679467679*^9}, {3.639309711506971*^9, 3.639309784810856*^9}, {
   3.639309957000609*^9, 3.639309964064227*^9}, {3.6393103365111227`*^9, 
   3.639310348447061*^9}, {3.639310639593882*^9, 3.639310642657853*^9}, {
   3.6393107336849833`*^9, 3.639310733812648*^9}, {3.639311527382782*^9, 
   3.639311540449951*^9}, {3.639312003272717*^9, 3.639312016377872*^9}, {
   3.63931209288701*^9, 3.639312100422309*^9}, {3.6393123420544643`*^9, 
   3.639312348265819*^9}, {3.63931259962953*^9, 3.639312602395903*^9}, {
   3.639312654273765*^9, 3.6393126627592916`*^9}, {3.6393129418539953`*^9, 
   3.6393129419977837`*^9}, {3.639313006811449*^9, 3.639313006879146*^9}, {
   3.63932648746663*^9, 3.639326489016946*^9}, {3.639327617415246*^9, 
   3.639327617693534*^9}, {3.6393282073276176`*^9, 3.639328209357647*^9}, {
   3.639329479258812*^9, 3.639329479378211*^9}, {3.639330991321507*^9, 
   3.639330992608869*^9}, {3.639386792123632*^9, 3.639386797412517*^9}, {
   3.639386838449286*^9, 3.639386838680189*^9}, {3.63938734533405*^9, 
   3.6393873571894417`*^9}, {3.639387389728524*^9, 3.639387408226169*^9}, {
   3.639387484527886*^9, 3.6393875513032093`*^9}, {3.6393876015994043`*^9, 
   3.6393876228316307`*^9}, {3.639387669595191*^9, 3.639387671153927*^9}, {
   3.639387753256773*^9, 3.639387769008007*^9}, {3.6394149352534847`*^9, 
   3.639414935346854*^9}, {3.6394210961079884`*^9, 3.639421108883497*^9}, 
   3.639421179687042*^9, {3.639421246799255*^9, 3.6394212574907093`*^9}, {
   3.6394218248283157`*^9, 3.639421830059964*^9}, {3.639482972661294*^9, 
   3.639482973773301*^9}, {3.6394830321289062`*^9, 3.639483032554599*^9}, {
   3.639483065805765*^9, 3.639483114587779*^9}, {3.639483156612276*^9, 
   3.63948319559669*^9}, {3.639483237771079*^9, 3.639483418159377*^9}, 
   3.639483468163784*^9, {3.6394835747661343`*^9, 3.639483583901441*^9}, {
   3.639483614355476*^9, 3.6394836147124977`*^9}, {3.639483655660782*^9, 
   3.639483657579376*^9}, {3.639483883722186*^9, 3.639483884233877*^9}, {
   3.639486600250779*^9, 3.639486606841213*^9}, {3.6394867681466618`*^9, 
   3.6394867684186153`*^9}, {3.639486840382924*^9, 3.639486868929947*^9}, {
   3.639487008784273*^9, 3.639487008873938*^9}}],

Cell[BoxData["Predictors"], "Output",
 CellChangeTimes->{{3.639483477255005*^9, 3.6394834984636717`*^9}, {
   3.639483561229218*^9, 3.639483588313443*^9}, 3.639483621829064*^9, 
   3.639483658328075*^9, 3.6394838847521973`*^9, 3.639486607184709*^9, 
   3.639486770456421*^9, 3.639486801256256*^9, {3.639486841859568*^9, 
   3.6394868692310133`*^9}, 3.639487009361315*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  StyleBox[
   RowBox[{"Predictor", " ", "results"}], "Title"], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"measures", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", " ", 
   RowBox[{"i", " ", "\[LessEqual]", 
    RowBox[{"Length", "[", "methods", "]"}]}], ",", " ", 
   RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"predictedPrices", " ", "=", " ", 
     RowBox[{"predictedPricesAllMethods", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "i"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"mae", " ", "=", " ", 
     RowBox[{
      RowBox[{"Total", "[", 
       RowBox[{"Abs", "[", " ", 
        RowBox[{"predictedPrices", "-", "realPrices"}], "]"}], "]"}], " ", 
      "/", " ", 
      RowBox[{"Length", "[", "realPrices", "]"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"mape", " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"Total", "[", 
        RowBox[{"Abs", "[", " ", 
         RowBox[{
          RowBox[{"predictedPrices", "/", "realPrices"}], "-", "1"}], "]"}], 
        "]"}], " ", "/", " ", 
       RowBox[{"Length", "[", "realPrices", "]"}]}], "*", "100"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"mapeNaive", " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"Total", "[", 
        RowBox[{"Abs", "[", "  ", 
         RowBox[{
          RowBox[{"predictedPrices", "/", " ", 
           RowBox[{"predictedPricesAllMethods", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "5"}], "]"}], "]"}]}], "-", "1"}], "]"}], 
        "]"}], " ", "/", " ", 
       RowBox[{"Length", "[", "realPrices", "]"}]}], "*", "100"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"movementAccuracy", " ", "=", " ", 
     RowBox[{
      RowBox[{"Total", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Sign", "[", 
            RowBox[{"predictedPrices", "-", "beforeRealPrices"}], "]"}], " ", 
           "*", " ", 
           RowBox[{"Sign", "[", 
            RowBox[{"realPrices", "-", "beforeRealPrices"}], "]"}]}], "+", 
          "1"}], ")"}], "/", "2"}], "]"}], " ", "/", " ", 
      RowBox[{"Length", "[", "realPrices", "]"}]}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"money", " ", "=", " ", "1"}], ";", "\[IndentingNewLine]", 
    RowBox[{"For", " ", "[", 
     RowBox[{
      RowBox[{"t", " ", "=", " ", "2"}], ",", " ", 
      RowBox[{"t", " ", "\[LessEqual]", 
       RowBox[{"Length", "[", "predictedPrices", "]"}]}], ",", " ", 
      RowBox[{"t", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{"If", " ", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"predictedPrices", "[", 
          RowBox[{"[", "t", "]"}], "]"}], " ", "\[GreaterEqual]", 
         RowBox[{"realPrices", "[", 
          RowBox[{"[", 
           RowBox[{"t", "-", "1"}], "]"}], "]"}]}], ",", " ", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"money", " ", "*=", " ", 
          RowBox[{
           RowBox[{"realPrices", "[", 
            RowBox[{"[", "t", "]"}], "]"}], " ", "/", " ", 
           RowBox[{"realPrices", "[", 
            RowBox[{"[", 
             RowBox[{"t", "-", "1"}], "]"}], "]"}]}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"moneyNoFees", " ", "=", " ", "money"}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"money", " ", "=", " ", "1"}], ";", "\[IndentingNewLine]", 
    RowBox[{"hasInvested", " ", "=", " ", "True"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"For", " ", "[", 
      RowBox[{
       RowBox[{"t", " ", "=", " ", "2"}], ",", " ", 
       RowBox[{"t", " ", "\[LessEqual]", 
        RowBox[{"Length", "[", "predictedPrices", "]"}]}], ",", " ", 
       RowBox[{"t", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"transactionFee", " ", "=", " ", 
         RowBox[{"money", " ", "*", " ", 
          RowBox[{"0.14", " ", "/", " ", "100"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", " ", "[", 
         RowBox[{"hasInvested", ",", "\[IndentingNewLine]", 
          RowBox[{"If", " ", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"predictedPrices", "[", 
               RowBox[{"[", "t", "]"}], "]"}], " ", "+", " ", 
              "transactionFee"}], " ", "<", 
             RowBox[{"realPrices", "[", 
              RowBox[{"[", 
               RowBox[{"t", "-", "1"}], "]"}], "]"}]}], ",", "  ", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"money", " ", "-=", " ", "transactionFee"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"hasInvested", "=", "False"}], ";"}], 
            "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"money", " ", "*=", " ", 
              RowBox[{
               RowBox[{"realPrices", "[", 
                RowBox[{"[", "t", "]"}], "]"}], " ", "/", " ", 
               RowBox[{"realPrices", "[", 
                RowBox[{"[", 
                 RowBox[{"t", "-", "1"}], "]"}], "]"}]}]}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
          "\[IndentingNewLine]", 
          RowBox[{"If", " ", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"predictedPrices", "[", 
               RowBox[{"[", "t", "]"}], "]"}], " ", "-", " ", 
              "transactionFee"}], " ", "\[GreaterEqual]", 
             RowBox[{"realPrices", "[", 
              RowBox[{"[", 
               RowBox[{"t", "-", "1"}], "]"}], "]"}]}], ",", "  ", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"money", " ", "=", " ", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"money", "-", "transactionFee"}], ")"}], "*", 
               RowBox[{
                RowBox[{"realPrices", "[", 
                 RowBox[{"[", "t", "]"}], "]"}], " ", "/", " ", 
                RowBox[{"realPrices", "[", 
                 RowBox[{"[", 
                  RowBox[{"t", "-", "1"}], "]"}], "]"}]}]}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"hasInvested", "=", "True"}], ";"}]}], 
           "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], 
        ";"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], 
     "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"measures", ",", 
       RowBox[{"{", 
        RowBox[{
        "mae", ",", " ", "mape", ",", " ", "mapeNaive", ",", " ", 
         "moneyNoFees", ",", " ", "money", ",", " ", 
         RowBox[{"N", "[", "movementAccuracy", "]"}]}], "}"}]}], "]"}]}], 
    ";"}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"table", " ", "=", " ", 
   RowBox[{"TableForm", "[", 
    RowBox[{"measures", ",", 
     RowBox[{"TableHeadings", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"methods", ",", " ", 
        RowBox[{"{", 
         RowBox[{
         "\"\<MAE\>\"", ",", " ", "\"\<MAPE\>\"", ",", " ", 
          "\"\<MAPE naive\>\"", ",", "\"\<Investment profit no fees\>\"", ",",
           " ", "\"\<Investment profit\>\"", ",", " ", 
          "\"\<Movement accuracy\>\""}], "}"}]}], "}"}]}]}], "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Manipulate", "[", 
    RowBox[{
     RowBox[{"ListLinePlot", "[", "fs", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"fs", ",", "funcs", ",", 
       RowBox[{"ControlType", "\[Rule]", "TogglerBar"}]}], "}"}]}], "]"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"plotMethods", " ", "=", " ", 
   RowBox[{"Append", "[", 
    RowBox[{"methods", ",", " ", "\"\<Real\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"funcs", "=", 
   RowBox[{"Append", "[", 
    RowBox[{
     RowBox[{"predictedPricesAllMethods", "\[Transpose]"}], ",", " ", 
     "realPrices"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Manipulate", "[", 
   RowBox[{
    RowBox[{"ListLinePlot", "[", 
     RowBox[{
      RowBox[{"funcs", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Position", "[", 
            RowBox[{"plotMethods", ",", " ", "#"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "&"}], " ", "/@", " ",
          "x"}], "]"}], "]"}], ",", " ", 
      RowBox[{"PlotLegends", "\[Rule]", "x"}], ",", " ", 
      RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", " ", 
        RowBox[{"{", "\"\<Real\>\"", "}"}], ",", " ", "\"\<zebra\>\""}], 
       "}"}], ",", "plotMethods", ",", " ", 
      RowBox[{"ControlType", "\[Rule]", "TogglerBar"}]}], "}"}]}], "]"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"ListLinePlot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"realPrices", ",", " ", 
       RowBox[{"predictedPricesAllMethods", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", " ", 
       RowBox[{"predictedPricesAllMethods", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", " ", 
       RowBox[{"predictedPricesAllMethods", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "3"}], "]"}], "]"}], ",", " ", 
       RowBox[{"predictedPricesAllMethods", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "4"}], "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"PlotLegends", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<Real prices\>\"", ",", " ", "\"\<Predicted Prices\>\""}], 
       "}"}]}]}], "]"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.639308375776013*^9, 3.6393084395766172`*^9}, {
   3.639308478386278*^9, 3.639308484230022*^9}, {3.639308834971859*^9, 
   3.639308843557012*^9}, {3.639308894401366*^9, 3.639308925652276*^9}, 
   3.639308968860968*^9, {3.639309833961916*^9, 3.639309847497465*^9}, {
   3.6393099830820417`*^9, 3.639310077532445*^9}, {3.639310114133486*^9, 
   3.639310141254558*^9}, {3.6393102128048487`*^9, 3.639310283828279*^9}, 
   3.6393103183939342`*^9, {3.639310370198224*^9, 3.639310425241407*^9}, {
   3.639310520423923*^9, 3.6393105471465607`*^9}, {3.639310617203619*^9, 
   3.639310637248555*^9}, {3.639310673005175*^9, 3.6393107055053463`*^9}, {
   3.639310773791362*^9, 3.639311258663476*^9}, {3.639311302688168*^9, 
   3.639311342352627*^9}, {3.6393113804123173`*^9, 3.639311513037754*^9}, {
   3.6393115966335487`*^9, 3.639311745830323*^9}, {3.639311788479826*^9, 
   3.639311827468862*^9}, {3.639311882795429*^9, 3.6393119322989273`*^9}, {
   3.6393119700073557`*^9, 3.639311996301506*^9}, {3.639312150431155*^9, 
   3.639312321736104*^9}, {3.63931235802431*^9, 3.639312370706019*^9}, {
   3.639312442356002*^9, 3.639312442742838*^9}, {3.639312574868527*^9, 
   3.639312577013076*^9}, {3.639312796806632*^9, 3.639312814471046*^9}, 
   3.639315685124283*^9, {3.6393157235923367`*^9, 3.639315724846878*^9}, {
   3.639315758830103*^9, 3.639315899404414*^9}, {3.6393270163111153`*^9, 
   3.6393270519058723`*^9}, {3.639327082015224*^9, 3.6393270991127977`*^9}, {
   3.6393271826821527`*^9, 3.639327262711204*^9}, {3.639327317984795*^9, 
   3.639327321722581*^9}, 3.639386859477049*^9, {3.639387271395067*^9, 
   3.639387321653275*^9}, {3.639421865535125*^9, 3.639421887343013*^9}, 
   3.6394219308916283`*^9, {3.639421964544243*^9, 3.639422168486739*^9}, {
   3.639422203190096*^9, 3.639422203428009*^9}, {3.639422235438696*^9, 
   3.639422297332337*^9}, {3.639422341665393*^9, 3.6394225114281893`*^9}, {
   3.639422548170969*^9, 3.6394225910827227`*^9}, {3.639422647559268*^9, 
   3.639422655830847*^9}, {3.639422730969141*^9, 3.639422745506806*^9}, {
   3.6394228575799227`*^9, 3.639422867162777*^9}, {3.6394818167526627`*^9, 
   3.639481817961203*^9}, {3.63948298014205*^9, 3.639482981342917*^9}, {
   3.639483784873857*^9, 3.639483833458336*^9}, {3.639483969415167*^9, 
   3.639483973939396*^9}, {3.639484282674542*^9, 3.639484342674213*^9}, {
   3.639484373398699*^9, 3.639484422593494*^9}, {3.639484452956255*^9, 
   3.639484616872572*^9}, {3.639484647462123*^9, 3.639485087463098*^9}, {
   3.6394851180898523`*^9, 3.639485119653614*^9}, {3.639485187186225*^9, 
   3.639485209159114*^9}, {3.6394852428286057`*^9, 3.639485249001183*^9}, {
   3.63948528239683*^9, 3.639485357089663*^9}, {3.639485388473773*^9, 
   3.639485410966051*^9}, {3.639485624573728*^9, 3.639485652600708*^9}, {
   3.639485918195084*^9, 3.639486003519938*^9}, {3.639486112479765*^9, 
   3.639486163327276*^9}, {3.6394865479944067`*^9, 3.639486584146934*^9}, {
   3.6394871625566196`*^9, 3.639487164974909*^9}, {3.639487223055913*^9, 
   3.639487235825008*^9}, {3.639487275341889*^9, 3.639487276170363*^9}, {
   3.6394873069805737`*^9, 3.639487309934552*^9}, {3.6394874900844507`*^9, 
   3.6394874920545273`*^9}, 3.6394875684820433`*^9, {3.639487603615506*^9, 
   3.639487799714506*^9}, {3.639487842972494*^9, 3.639487843900961*^9}, {
   3.639487941951079*^9, 3.63948794263688*^9}, 3.63948799334803*^9, {
   3.6394880298824053`*^9, 3.639488030240583*^9}}],

Cell[BoxData[
 RowBox[{"Predictor", " ", "results"}]], "Output",
 CellChangeTimes->{
  3.639485402607679*^9, {3.639485627172639*^9, 3.639485654046735*^9}, 
   3.639485933625415*^9, {3.639485976519964*^9, 3.639486004208729*^9}, {
   3.639486156354986*^9, 3.639486163882512*^9}, {3.639486551792794*^9, 
   3.63948658442785*^9}, 3.6394866782585278`*^9, {3.63948677980614*^9, 
   3.639486808693832*^9}, 3.639486882471184*^9, 3.639487041177144*^9, 
   3.63948731083423*^9, 3.639487492563444*^9, 3.6394876531953077`*^9, {
   3.639487763921702*^9, 3.639487800176392*^9}, 3.639487847759288*^9}],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      StyleBox["\[Null]",
       ShowStringCharacters->False], 
      TagBox["\<\"MAE\"\>",
       HoldForm], 
      TagBox["\<\"MAPE\"\>",
       HoldForm], 
      TagBox["\<\"MAPE naive\"\>",
       HoldForm], 
      TagBox["\<\"Investment profit no fees\"\>",
       HoldForm], 
      TagBox["\<\"Investment profit\"\>",
       HoldForm], 
      TagBox["\<\"Movement accuracy\"\>",
       HoldForm]},
     {
      TagBox["\<\"NearestNeighbors\"\>",
       HoldForm], "42.14304988654426`", "0.7190983937222531`", 
      "0.11033949939042503`", "1.0073042929101919`", "0.9591032110316264`", 
      "0.5652173913043478`"},
     {
      TagBox["\<\"NeuralNetwork\"\>",
       HoldForm], "41.95208419227271`", "0.7155927273522115`", 
      "0.13899184411700086`", "0.9705461513922679`", "0.9384554764756062`", 
      "0.5217391304347826`"},
     {
      TagBox["\<\"RandomForest\"\>",
       HoldForm], "41.99499879316629`", "0.7165941159824191`", 
      "0.15884589581513534`", "0.9729065426167988`", "0.9394207894673855`", 
      "0.5507246376811594`"},
     {
      TagBox["\<\"LinearRegression\"\>",
       HoldForm], "42.64563925862369`", "0.727205780966861`", 
      "0.07275544549151376`", "0.9785224898061998`", "0.9757845447388225`", 
      "0.5072463768115942`"},
     {
      TagBox["\<\"Naive\"\>",
       HoldForm], "42.034759420289895`", "0.7165867037946712`", 
      "1.12631321338784`*^-15", "0.9785224898061998`", "0.9785224898061998`", 
      "0.5`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxDividers->{
     "Columns" -> {False, True, {False}, False}, "ColumnsIndexed" -> {}, 
      "Rows" -> {False, True, {False}, False}, "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[2.0999999999999996`]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}],
   {OutputFormsDump`HeadedRows, OutputFormsDump`HeadedColumns}],
  Function[BoxForm`e$, 
   TableForm[
   BoxForm`e$, 
    TableHeadings -> {{
      "NearestNeighbors", "NeuralNetwork", "RandomForest", "LinearRegression",
        "Naive"}, {
      "MAE", "MAPE", "MAPE naive", "Investment profit no fees", 
       "Investment profit", "Movement accuracy"}}]]]], "Output",
 CellChangeTimes->{
  3.639485402607679*^9, {3.639485627172639*^9, 3.639485654046735*^9}, 
   3.639485933625415*^9, {3.639485976519964*^9, 3.639486004208729*^9}, {
   3.639486156354986*^9, 3.639486163882512*^9}, {3.639486551792794*^9, 
   3.63948658442785*^9}, 3.6394866782585278`*^9, {3.63948677980614*^9, 
   3.639486808693832*^9}, 3.639486882471184*^9, 3.639487041177144*^9, 
   3.63948731083423*^9, 3.639487492563444*^9, 3.6394876531953077`*^9, {
   3.639487763921702*^9, 3.639487800176392*^9}, 3.6394878477685137`*^9}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`x$$ = {}, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`x$$], {"Real"}, "zebra"}, {
      "NearestNeighbors", "NeuralNetwork", "RandomForest", "LinearRegression",
        "Naive", "Real"}}}, Typeset`size$$ = {576., {179., 183.}}, 
    Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`x$1486094$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`x$$ = {"Real"}}, 
      "ControllerVariables" :> {
        Hold[$CellContext`x$$, $CellContext`x$1486094$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> ListLinePlot[
        Part[$CellContext`funcs, 
         Map[Part[
           Position[$CellContext`plotMethods, #], 1, 1]& , $CellContext`x$$]],
         PlotLegends -> $CellContext`x$$, ImageSize -> Large], 
      "Specifications" :> {{{$CellContext`x$$, {"Real"}, "zebra"}, {
         "NearestNeighbors", "NeuralNetwork", "RandomForest", 
          "LinearRegression", "Naive", "Real"}, ControlType -> TogglerBar}}, 
      "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{621., {221., 226.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.639485402607679*^9, {3.639485627172639*^9, 3.639485654046735*^9}, 
   3.639485933625415*^9, {3.639485976519964*^9, 3.639486004208729*^9}, {
   3.639486156354986*^9, 3.639486163882512*^9}, {3.639486551792794*^9, 
   3.63948658442785*^9}, 3.6394866782585278`*^9, {3.63948677980614*^9, 
   3.639486808693832*^9}, 3.639486882471184*^9, 3.639487041177144*^9, 
   3.63948731083423*^9, 3.639487492563444*^9, 3.6394876531953077`*^9, {
   3.639487763921702*^9, 3.639487800176392*^9}, 3.6394878479001207`*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  StyleBox["Classifiers", "Title"], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sampleSize", " ", "=", " ", "30"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"windowSize", " ", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"methods", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
    "\"\<NaiveBayes\>\"", ",", " ", "\"\<LogisticRegression\>\"", ",", " ", 
     "\"\<NearestNeighbors\>\"", ",", " ", "\"\<NeuralNetwork\>\"", ",", " ", 
     "\"\<SupportVectorMachine\>\"", ",", "\"\<RandomForest\>\""}], "}"}]}], 
  "\[NoBreak]", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"methods", " ", "=", " ", 
   RowBox[{"{", "\"\<NeuralNetwork\>\"", "}"}]}], "\[NoBreak]", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"priceChanges", " ", "=", " ", "allRealPrices"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"predictedPrices", " ", "=", " ", 
  RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"patterns", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"priceChanges", "[", 
          RowBox[{"[", 
           RowBox[{"j", ";;", 
            RowBox[{"j", "+", "windowSize", "-", "1"}]}], "]"}], "]"}], 
         "\[Rule]", 
         RowBox[{"Sign", "[", 
          RowBox[{
           RowBox[{"priceChanges", "[", 
            RowBox[{"[", 
             RowBox[{"j", "+", "windowSize"}], "]"}], "]"}], "-", 
           RowBox[{"priceChanges", "[", 
            RowBox[{"[", 
             RowBox[{"j", "+", "windowSize", "-", "1"}], "]"}], "]"}]}], 
          "]"}]}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"j", ",", " ", 
          RowBox[{"i", "-", "sampleSize", "+", "1"}], ",", 
          RowBox[{"i", "-", "windowSize"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"trainingPatterns", " ", "=", " ", 
      RowBox[{"patterns", "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", 
         RowBox[{"-", "2"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"testPatterns", " ", "=", " ", 
      RowBox[{"patterns", "[", 
       RowBox[{"[", 
        RowBox[{"-", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"predictors", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Classify", "[", 
         RowBox[{"trainingPatterns", ",", " ", 
          RowBox[{"Method", " ", "\[Rule]", "#"}], ",", " ", 
          RowBox[{"PerformanceGoal", "\[Rule]", "\"\<TrainingSpeed\>\""}]}], 
         "]"}], "&"}], "/@", "  ", "methods"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"If", " ", "[", 
        RowBox[{
         RowBox[{"i", " ", "\[Equal]", " ", "sampleSize"}], ",", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{"ClassifierInformation", "[", "#", "]"}], "]"}], " ", 
           "&"}], " ", "/@", " ", "predictors"}]}], "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"Keys", "[", "testPatterns", "]"}], "]"}], " ", "&"}], " ", "/@",
       "  ", "predictors"}]}], "\[IndentingNewLine]", ",", " ", 
    RowBox[{"{", 
     RowBox[{"i", ",", "sampleSize", ",", 
      RowBox[{"Length", "[", "priceChanges", "]"}]}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"realPrices", " ", "=", " ", 
   RowBox[{"allRealPrices", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Length", "[", "predictedPrices", "]"}]}], ";;", 
      RowBox[{"-", "1"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"beforeRealPrices", " ", "=", " ", 
   RowBox[{"allRealPrices", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Length", "[", "predictedPrices", "]"}]}], "-", "1"}], ";;", 
      RowBox[{"-", "2"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"predictedPricesAllMethods", " ", "=", " ", "predictedPrices"}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"AppendTo", "[", 
  RowBox[{"methods", ",", "\"\<Naive\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"predictedPricesAllMethods", " ", "=", " ", 
   RowBox[{
    RowBox[{"Append", "[", 
     RowBox[{
      RowBox[{"predictedPricesAllMethods", "\[Transpose]"}], ",", 
      "beforeRealPrices"}], "]"}], "\[Transpose]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{
  3.6393283154469957`*^9, {3.639328509166555*^9, 3.6393285932602377`*^9}, {
   3.639328978312738*^9, 3.639328978642516*^9}, {3.639329050115533*^9, 
   3.639329050274129*^9}, {3.639329307507063*^9, 3.639329307905937*^9}, {
   3.639329484978016*^9, 3.6393294851394157`*^9}, {3.639329679518248*^9, 
   3.639329680403595*^9}, {3.639330788768412*^9, 3.639330790031825*^9}, {
   3.6393310207632313`*^9, 3.639331027819089*^9}, {3.6393311531620483`*^9, 
   3.639331169076087*^9}, {3.6393313420994787`*^9, 3.639331344226624*^9}, {
   3.639331381298555*^9, 3.6393313822579823`*^9}, {3.6393314450215063`*^9, 
   3.639331447140607*^9}, {3.639331502198296*^9, 3.6393315038043203`*^9}, {
   3.639384360616971*^9, 3.639384360696185*^9}, {3.63938453979674*^9, 
   3.639384542186225*^9}, 3.639384774748145*^9, {3.639384888686368*^9, 
   3.6393849061126423`*^9}, {3.639385033213779*^9, 3.639385043519874*^9}, {
   3.639385358556423*^9, 3.6393853799269867`*^9}, {3.639386238480872*^9, 
   3.639386238560582*^9}, {3.639386299491623*^9, 3.639386322181839*^9}, {
   3.639386370592433*^9, 3.63938637091987*^9}, {3.6393865205729303`*^9, 
   3.639386528991028*^9}, {3.639386690798424*^9, 3.6393867132546673`*^9}, {
   3.6393868649760323`*^9, 3.6393868854809313`*^9}, 3.639387266349161*^9, {
   3.6394829967820807`*^9, 3.639483013825873*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  StyleBox[
   RowBox[{"Classifiers", " ", "results"}], "Title"], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"measures", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", " ", 
    RowBox[{"i", " ", "\[LessEqual]", 
     RowBox[{"Length", "[", "methods", "]"}]}], ",", " ", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"predictedPrices", " ", "=", " ", 
      RowBox[{"predictedPricesAllMethods", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "i"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"movementAccuracy", " ", "=", " ", 
      RowBox[{
       RowBox[{"Total", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"predictedPrices", " ", "*", " ", 
            RowBox[{"Sign", "[", 
             RowBox[{"realPrices", "-", "beforeRealPrices"}], "]"}]}], "+", 
           "1"}], ")"}], "/", "2"}], "]"}], " ", "/", " ", 
       RowBox[{"Length", "[", "realPrices", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"money", " ", "=", " ", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", " ", "[", 
      RowBox[{
       RowBox[{"t", " ", "=", " ", "2"}], ",", " ", 
       RowBox[{"t", " ", "\[LessEqual]", 
        RowBox[{"Length", "[", "predictedPrices", "]"}]}], ",", " ", 
       RowBox[{"t", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"If", " ", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"predictedPrices", "[", 
           RowBox[{"[", "t", "]"}], "]"}], " ", ">", " ", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"money", " ", "*=", " ", 
           RowBox[{
            RowBox[{"realPrices", "[", 
             RowBox[{"[", "t", "]"}], "]"}], " ", "/", " ", 
            RowBox[{"realPrices", "[", 
             RowBox[{"[", 
              RowBox[{"t", "-", "1"}], "]"}], "]"}]}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"measures", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"N", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"money", "-", "1"}], ")"}], ",", "3"}], "]"}], "*", 
          "100"}], ",", " ", 
         RowBox[{
          RowBox[{"N", "[", 
           RowBox[{"movementAccuracy", ",", "3"}], "]"}], "*", "100"}]}], 
        "}"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"table", " ", "=", " ", 
   RowBox[{"TableForm", "[", 
    RowBox[{"measures", ",", 
     RowBox[{"TableHeadings", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"methods", ",", " ", 
        RowBox[{"{", 
         RowBox[{
         "\"\<Investment profit\>\"", ",", " ", "\"\<Movement accuracy\>\""}],
          "}"}]}], "}"}]}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", "ListPlot", "\
\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.6393283317803383`*^9, 3.639328494592023*^9}, {
  3.63932866077357*^9, 3.6393287306590223`*^9}, {3.639328772752907*^9, 
  3.639328793122508*^9}, {3.639328837965007*^9, 3.6393288858635807`*^9}, {
  3.6393316141779413`*^9, 3.639331615416635*^9}, {3.6393852657194357`*^9, 
  3.63938526898868*^9}, {3.639483005486676*^9, 3.639483006520071*^9}}],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      StyleBox["\[Null]",
       ShowStringCharacters->False], 
      TagBox["\<\"Investment profit\"\>",
       HoldForm], 
      TagBox["\<\"Movement accuracy\"\>",
       HoldForm]},
     {
      TagBox["\<\"NeuralNetwork\"\>",
       HoldForm], 
      RowBox[{"-", "2.031118390278419`"}], 
      "44.87179487179487179487179487179487179491`3."},
     {
      TagBox["\<\"Naive\"\>",
       HoldForm], 
      RowBox[{"-", "0.610888992458658`"}], 
      RowBox[{"-", "7064.935128205128`"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxDividers->{
     "Columns" -> {False, True, {False}, False}, "ColumnsIndexed" -> {}, 
      "Rows" -> {False, True, {False}, False}, "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[2.0999999999999996`]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}],
   {OutputFormsDump`HeadedRows, OutputFormsDump`HeadedColumns}],
  Function[BoxForm`e$, 
   TableForm[
   BoxForm`e$, 
    TableHeadings -> {{"NeuralNetwork", "Naive"}, {
      "Investment profit", "Movement accuracy"}}]]]], "Output",
 CellChangeTimes->{
  3.639328965716292*^9, 3.63932903975667*^9, 3.6393291254027147`*^9, 
   3.639329261782962*^9, 3.639329466352448*^9, 3.639329603177359*^9, 
   3.639331064177038*^9, {3.639331396080666*^9, 3.639331410410096*^9}, {
   3.639331440462308*^9, 3.639331454685176*^9}, 3.639331617399762*^9, {
   3.639384563472378*^9, 3.639384570809306*^9}, 3.6393849213591833`*^9, 
   3.639384990498595*^9, 3.639385245593626*^9, {3.63938531767876*^9, 
   3.639385327573106*^9}, {3.639386289970709*^9, 3.6393863183409863`*^9}, 
   3.639386350062302*^9, 3.639386517515521*^9, 3.63938655048822*^9}],

Cell[BoxData["ListPlot"], "Output",
 CellChangeTimes->{
  3.639328965716292*^9, 3.63932903975667*^9, 3.6393291254027147`*^9, 
   3.639329261782962*^9, 3.639329466352448*^9, 3.639329603177359*^9, 
   3.639331064177038*^9, {3.639331396080666*^9, 3.639331410410096*^9}, {
   3.639331440462308*^9, 3.639331454685176*^9}, 3.639331617399762*^9, {
   3.639384563472378*^9, 3.639384570809306*^9}, 3.6393849213591833`*^9, 
   3.639384990498595*^9, 3.639385245593626*^9, {3.63938531767876*^9, 
   3.639385327573106*^9}, {3.639386289970709*^9, 3.6393863183409863`*^9}, 
   3.639386350062302*^9, 3.639386517515521*^9, 3.6393865504965677`*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.639328959568104*^9, 3.639328959574736*^9}}]
},
WindowSize->{1747, 903},
WindowMargins->{{Automatic, 15}, {82, Automatic}},
FrontEndVersion->"10.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (September 9, \
2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 7008, 119, 190, "Input"],
Cell[7591, 143, 2344, 33, 28, "Output"],
Cell[9938, 178, 2317, 32, 28, "Output"],
Cell[12258, 212, 12088, 229, 249, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[24383, 446, 9332, 189, 427, "Input"],
Cell[33718, 637, 371, 5, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[34126, 647, 13520, 298, 937, "Input"],
Cell[47649, 947, 586, 9, 28, "Output"],
Cell[48238, 958, 2997, 73, 128, "Output"],
Cell[51238, 1033, 2506, 47, 464, "Output"]
}, Open  ]],
Cell[53759, 1083, 5869, 137, 411, "Input"],
Cell[CellGroupData[{
Cell[59653, 1224, 3515, 87, 377, "Input"],
Cell[63171, 1313, 1953, 48, 65, "Output"],
Cell[65127, 1363, 630, 9, 28, "Output"]
}, Open  ]],
Cell[65772, 1375, 92, 1, 28, "Input"]
}
]
*)

(* End of internal cache information *)
